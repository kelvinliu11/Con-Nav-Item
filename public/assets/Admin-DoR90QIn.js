var Ne=Object.defineProperty,Ke=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var Be=(b,t,l)=>t in b?Ne(b,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):b[t]=l,be=(b,t)=>{for(var l in t||(t={}))Ee.call(t,l)&&Be(b,l,t[l]);if(xe)for(var l of xe(t))Re.call(t,l)&&Be(b,l,t[l]);return b},ke=(b,t)=>Ke(b,ze(t));var A=(b,t,l)=>new Promise((T,a)=>{var x=v=>{try{D(l.next(v))}catch(h){a(h)}},I=v=>{try{D(l.throw(v))}catch(h){a(h)}},D=v=>v.done?T(v.value):Promise.resolve(v.value).then(x,I);D((l=l.apply(b,t)).next())});import{_ as X,c,b as u,f as e,t as p,B as de,r as k,o as oe,d as N,l as U,v as L,p as Ce,F as q,e as G,i as re,w as Ue,C as ye,x as z,z as we,h as Me,g as E,D as ne,A as _e,s as le,E as Ie,a as Oe,k as He,m as Fe,T as qe,G as Ge,H as je,I as Je}from"./index-CJTmCuSt.js";import{g as Se,m as Qe,x as Xe,w as Ye,u as Ze,n as et,o as tt,c as Le,k as st,p as Ve,y as Ae,f as at,A as lt,B as ot,C as $e,D as nt,E as it,F as rt,G as dt,i as ie,b as ut,H as ct,I as vt,J as pt,K as mt,L as gt,M as bt,N as ft}from"./urlNormalizer-C1P8Mrum.js";const ht={class:"welcome-page"},yt={class:"welcome-title"},wt={class:"welcome-cards"},kt={class:"welcome-card"},_t={class:"welcome-value"},$t={class:"welcome-card"},Ct={class:"welcome-value"},Mt={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(b){return(t,l)=>(u(),c("div",ht,[e("h2",yt,"æ¬¢è¿æ‚¨ï¼Œ"+p(b.currentUsername||"admin")+"ï¼",1),e("div",wt,[e("div",kt,[l[0]||(l[0]=de('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",_t,p(b.lastLoginTime||"--"),1)]),e("div",$t,[l[1]||(l[1]=de('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",Ct,p(b.lastLoginIp||"--"),1)])])]))}},xt=X(Mt,[["__scopeId","data-v-5cc4f846"]]),Bt={class:"menu-manage"},Ut={key:0,class:"loading-overlay"},Vt={class:"menu-header"},At={class:"menu-add"},Tt=["disabled"],Dt={class:"menu-content"},It={key:0,class:"empty-state"},St={class:"menu-card-header"},Lt={class:"menu-title"},Pt={class:"menu-name"},Wt={class:"menu-order"},Nt={class:"menu-actions"},Kt=["onClick"],zt=["onClick"],Et=["onClick"],Rt={key:0,class:"sub-menu-list"},Ot={class:"sub-menu-name"},Ht={class:"sub-menu-order"},Ft={class:"sub-menu-actions"},qt=["onClick"],Gt=["onClick"],jt={key:1,class:"no-sub-menu"},Jt={key:1,class:"modal-overlay"},Qt={class:"modal"},Xt={class:"modal-header"},Yt={class:"modal-body"},Zt={class:"form-group"},es={class:"form-group"},ts={class:"modal-footer"},ss=["disabled"],as={key:2,class:"modal-overlay"},ls={class:"modal"},os={class:"modal-header"},ns={class:"modal-body"},is={class:"form-group"},rs={class:"form-group"},ds={class:"modal-footer"},us=["disabled"],cs={key:3,class:"modal-overlay"},vs={class:"modal"},ps={class:"modal-body"},ms={class:"form-group"},gs={class:"form-group"},bs={class:"modal-footer"},fs=["disabled"],hs={__name:"MenuManage",setup(b){const t=k([]),l=k(!1),T=k("åŠ è½½ä¸­..."),a=k(""),x=k(!1),I=k(null),D=k({name:"",order:0}),v=k(!1),h=k(null),y=k(""),g=k({name:"",order:0}),d=k(!1),f=k(null),i=k({name:"",order:0});oe(()=>{n()});function r(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[æ ç›®ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(W){console.warn("[æ ç›®ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",W)}}function n(W=!1){return A(this,null,function*(){var w,V;l.value=!0,T.value="åŠ è½½ä¸­...";try{const S=yield Se(!0);t.value=S.data||[],W&&r()}catch(S){alert("åŠ è½½å¤±è´¥: "+(((V=(w=S.response)==null?void 0:w.data)==null?void 0:V.error)||S.message))}finally{l.value=!1}})}function B(){return A(this,null,function*(){var W,w;if(a.value.trim()){l.value=!0,T.value="æ·»åŠ ä¸­...";try{const V=t.value.length?Math.max(...t.value.map(S=>S.order||0)):0;yield Qe({name:a.value.trim(),order:V+1}),a.value="",yield n(!0)}catch(V){alert("æ·»åŠ å¤±è´¥: "+(((w=(W=V.response)==null?void 0:W.data)==null?void 0:w.error)||V.message)),l.value=!1}}})}function C(W){I.value=W,D.value={name:W.name,order:W.order},x.value=!0}function M(){return A(this,null,function*(){var S,m;if(!D.value.name.trim()||!I.value)return;const W=I.value.id,w=D.value.name.trim(),V=D.value.order;O(),l.value=!0,T.value="ä¿å­˜ä¸­...";try{yield Ze(W,{name:w,order:V}),yield n(!0)}catch(o){alert("ä¿å­˜å¤±è´¥: "+(((m=(S=o.response)==null?void 0:S.data)==null?void 0:m.error)||o.message)),l.value=!1}})}function R(W){return A(this,null,function*(){var w,V;if(confirm(`ç¡®å®šåˆ é™¤ä¸»èœå•ã€Œ${W.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ï¼`)){l.value=!0,T.value="åˆ é™¤ä¸­...";try{yield Xe(W.id),yield n(!0)}catch(S){alert("åˆ é™¤å¤±è´¥: "+(((V=(w=S.response)==null?void 0:w.data)==null?void 0:V.error)||S.message)),l.value=!1}}})}function Y(W){h.value=W.id,y.value=W.name;const w=W.subMenus||[],V=w.length?Math.max(...w.map(S=>S.order||0)):0;g.value={name:"",order:V+1},v.value=!0}function Z(){return A(this,null,function*(){var S,m;if(!g.value.name.trim()||!h.value)return;const W=h.value,w=g.value.name.trim(),V=g.value.order;O(),l.value=!0,T.value="æ·»åŠ ä¸­...";try{yield et(W,{name:w,order:V}),yield n(!0)}catch(o){alert("æ·»åŠ å¤±è´¥: "+(((m=(S=o.response)==null?void 0:S.data)==null?void 0:m.error)||o.message)),l.value=!1}})}function ee(W,w){f.value=w,i.value={name:w.name,order:w.order},d.value=!0}function se(){return A(this,null,function*(){var S,m;if(!i.value.name.trim()||!f.value)return;const W=f.value.id,w=i.value.name.trim(),V=i.value.order;O(),l.value=!0,T.value="ä¿å­˜ä¸­...";try{yield tt(W,{name:w,order:V}),yield n(!0)}catch(o){alert("ä¿å­˜å¤±è´¥: "+(((m=(S=o.response)==null?void 0:S.data)==null?void 0:m.error)||o.message)),l.value=!1}})}function H(W){return A(this,null,function*(){var w,V;if(confirm(`ç¡®å®šåˆ é™¤å­èœå•ã€Œ${W.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å¡ç‰‡ï¼`)){l.value=!0,T.value="åˆ é™¤ä¸­...";try{yield Ye(W.id),yield n(!0)}catch(S){alert("åˆ é™¤å¤±è´¥: "+(((V=(w=S.response)==null?void 0:w.data)==null?void 0:V.error)||S.message)),l.value=!1}}})}function O(){x.value=!1,v.value=!1,d.value=!1,I.value=null,f.value=null}return(W,w)=>(u(),c("div",Bt,[l.value?(u(),c("div",Ut,[w[7]||(w[7]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,p(T.value),1)])):N("",!0),e("div",Vt,[w[8]||(w[8]=e("h2",{class:"page-title"},"æ ç›®ç®¡ç†",-1)),e("div",At,[U(e("input",{"onUpdate:modelValue":w[0]||(w[0]=V=>a.value=V),placeholder:"è¾“å…¥ä¸»èœå•åç§°",class:"input",onKeyup:Ce(B,["enter"])},null,544),[[L,a.value]]),e("button",{class:"btn btn-primary",onClick:B,disabled:l.value||!a.value.trim()}," + æ·»åŠ ä¸»èœå• ",8,Tt)])]),e("div",Dt,[t.value.length===0?(u(),c("div",It,[...w[9]||(w[9]=[e("p",null,"æš‚æ— èœå•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªä¸»èœå•",-1)])])):N("",!0),(u(!0),c(q,null,G(t.value,V=>(u(),c("div",{key:V.id,class:"menu-card"},[e("div",St,[e("div",Lt,[e("span",Pt,p(V.name),1),e("span",Wt,"æ’åº: "+p(V.order),1)]),e("div",Nt,[e("button",{class:"btn-icon btn-edit",onClick:S=>C(V),title:"ç¼–è¾‘"},[...w[10]||(w[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Kt),e("button",{class:"btn-icon btn-add",onClick:S=>Y(V),title:"æ·»åŠ å­èœå•"},[...w[11]||(w[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1)])],8,zt),e("button",{class:"btn-icon btn-delete",onClick:S=>R(V),title:"åˆ é™¤"},[...w[12]||(w[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Et)])]),V.subMenus&&V.subMenus.length>0?(u(),c("div",Rt,[(u(!0),c(q,null,G(V.subMenus,S=>(u(),c("div",{key:S.id,class:"sub-menu-item"},[e("span",Ot,p(S.name),1),e("span",Ht,"æ’åº: "+p(S.order),1),e("div",Ft,[e("button",{class:"btn-icon-sm btn-edit",onClick:m=>ee(V,S),title:"ç¼–è¾‘"},[...w[13]||(w[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,qt),e("button",{class:"btn-icon-sm btn-delete",onClick:m=>H(S),title:"åˆ é™¤"},[...w[14]||(w[14]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Gt)])]))),128))])):(u(),c("div",jt,[...w[15]||(w[15]=[e("span",null,"æš‚æ— å­èœå•",-1)])]))]))),128))]),x.value?(u(),c("div",Jt,[e("div",Qt,[e("div",Xt,[e("h3",null,p(I.value?"ç¼–è¾‘ä¸»èœå•":"æ·»åŠ å­èœå•"),1),e("button",{class:"modal-close",onClick:O},"Ã—")]),e("div",Yt,[e("div",Zt,[w[16]||(w[16]=e("label",null,"åç§°",-1)),U(e("input",{"onUpdate:modelValue":w[1]||(w[1]=V=>D.value.name=V),type:"text",class:"input",placeholder:"è¯·è¾“å…¥åç§°"},null,512),[[L,D.value.name]])]),e("div",es,[w[17]||(w[17]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":w[2]||(w[2]=V=>D.value.order=V),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,D.value.order,void 0,{number:!0}]])])]),e("div",ts,[e("button",{class:"btn btn-cancel",onClick:O},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:M,disabled:!D.value.name.trim()},"ä¿å­˜",8,ss)])])])):N("",!0),v.value?(u(),c("div",as,[e("div",ls,[e("div",os,[e("h3",null,"æ·»åŠ å­èœå•åˆ°ã€Œ"+p(y.value)+"ã€",1),e("button",{class:"modal-close",onClick:O},"Ã—")]),e("div",ns,[e("div",is,[w[18]||(w[18]=e("label",null,"å­èœå•åç§°",-1)),U(e("input",{"onUpdate:modelValue":w[3]||(w[3]=V=>g.value.name=V),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,g.value.name]])]),e("div",rs,[w[19]||(w[19]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":w[4]||(w[4]=V=>g.value.order=V),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,g.value.order,void 0,{number:!0}]])])]),e("div",ds,[e("button",{class:"btn btn-cancel",onClick:O},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:Z,disabled:!g.value.name.trim()},"æ·»åŠ ",8,us)])])])):N("",!0),d.value?(u(),c("div",cs,[e("div",vs,[e("div",{class:"modal-header"},[w[20]||(w[20]=e("h3",null,"ç¼–è¾‘å­èœå•",-1)),e("button",{class:"modal-close",onClick:O},"Ã—")]),e("div",ps,[e("div",ms,[w[21]||(w[21]=e("label",null,"å­èœå•åç§°",-1)),U(e("input",{"onUpdate:modelValue":w[5]||(w[5]=V=>i.value.name=V),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,i.value.name]])]),e("div",gs,[w[22]||(w[22]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":w[6]||(w[6]=V=>i.value.order=V),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,i.value.order,void 0,{number:!0}]])])]),e("div",bs,[e("button",{class:"btn btn-cancel",onClick:O},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:!i.value.name.trim()},"ä¿å­˜",8,fs)])])])):N("",!0)]))}},ys=X(hs,[["__scopeId","data-v-7671c3a1"]]),ws={class:"card-manage"},ks={class:"card-header"},_s={class:"card-add"},$s=["value"],Cs=["value"],Ms={class:"card-card"},xs={class:"card-table"},Bs=["onUpdate:modelValue","onBlur"],Us=["onUpdate:modelValue","onBlur"],Vs=["onUpdate:modelValue","onBlur"],As=["onUpdate:modelValue","onBlur"],Ts=["onClick"],Ds={key:0,class:"selected-tags"},Is={key:1,class:"tag-placeholder"},Ss=["onUpdate:modelValue","onBlur"],Ls=["onClick"],Ps={class:"modal-body"},Ws={key:0,class:"empty-tags"},Ns={key:1,class:"tag-options"},Ks=["checked","onChange"],zs={class:"modal-body"},Es={class:"duplicate-comparison"},Rs={class:"card-info-box existing"},Os={class:"card-details"},Hs={class:"detail-row"},Fs={class:"detail-value"},qs={class:"detail-row"},Gs={class:"detail-value url"},js={key:0,class:"detail-row"},Js={class:"detail-value url"},Qs={class:"card-info-box pending"},Xs={class:"card-details"},Ys={class:"detail-row"},Zs={class:"detail-value"},ea={class:"detail-row"},ta={class:"detail-value url"},sa={key:0,class:"detail-row"},aa={class:"detail-value url"},la={__name:"CardManage",setup(b){const t=k([]),l=k([]),T=k(),a=k(""),x=k(""),I=k(""),D=k(""),v=k([]),h=k(!1),y=k(null),g=k([]),d=k(!1),f=k(null),i=k(null),r=re(()=>{if(!T.value)return[];const m=t.value.find(o=>o.id===T.value);return(m==null?void 0:m.subMenus)||[]});oe(()=>A(null,null,function*(){const m=yield Se();t.value=m.data,t.value.length&&(T.value=t.value[0].id,a.value="");const o=yield Le();v.value=o.data})),Ue(T,()=>{a.value="",C()}),Ue(a,C);function n(){a.value=""}function B(){C()}function C(){return A(this,null,function*(){if(!T.value)return;const m=yield at(T.value,a.value||null);l.value=m.data})}function M(){return A(this,null,function*(){if(!x.value||!I.value)return;const m=l.value.find(o=>st({title:x.value,url:I.value},o));m?(f.value=m,i.value={menu_id:T.value,sub_menu_id:a.value||null,title:x.value,url:I.value,logo_url:D.value},d.value=!0):yield O({menu_id:T.value,sub_menu_id:a.value||null,title:x.value,url:I.value,logo_url:D.value})})}function R(m){return A(this,null,function*(){yield Ve(m.id,{menu_id:T.value,sub_menu_id:a.value||null,title:m.title,url:m.url,logo_url:m.logo_url,desc:m.desc,order:m.order,tagIds:m.tags?m.tags.map(o=>o.id):[]}),C()})}function Y(m){return A(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const o=l.value.findIndex(ae=>ae.id===m);o>-1&&l.value.splice(o,1);try{yield Ae(m)}catch(ae){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",ae),yield C()}})}function Z(m){y.value=m,g.value=m.tags?m.tags.map(o=>o.id):[],h.value=!0}function ee(){h.value=!1,y.value=null,g.value=[]}function se(m){const o=g.value.indexOf(m);o>-1?g.value.splice(o,1):g.value.push(m)}function H(){return A(this,null,function*(){y.value&&(yield Ve(y.value.id,{menu_id:y.value.menu_id,sub_menu_id:y.value.sub_menu_id,title:y.value.title,url:y.value.url,logo_url:y.value.logo_url,desc:y.value.desc,order:y.value.order,tagIds:g.value}),ee(),C())})}function O(m){return A(this,null,function*(){yield lt(m),x.value="",I.value="",D.value="",C()})}function W(){d.value=!1,f.value=null,i.value=null}function w(){W(),x.value="",I.value="",D.value=""}function V(){return A(this,null,function*(){!i.value||!f.value||(yield Ae(f.value.id),yield O(i.value),W())})}function S(){i.value&&(x.value=i.value.title,I.value=i.value.url,D.value=i.value.logo_url||"",W(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(m,o)=>{var ae,ue,ce,ve,Q,pe,me,te;return u(),c("div",ws,[e("div",ks,[o[9]||(o[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",_s,[U(e("select",{"onUpdate:modelValue":o[0]||(o[0]=P=>T.value=P),class:"input narrow",onChange:n},[(u(!0),c(q,null,G(t.value,P=>(u(),c("option",{value:P.id,key:P.id},p(P.name),9,$s))),128))],544),[[ye,T.value]]),U(e("select",{"onUpdate:modelValue":o[1]||(o[1]=P=>a.value=P),class:"input narrow",onChange:B},[o[7]||(o[7]=e("option",{value:""},"ä¸»èœå•",-1)),(u(!0),c(q,null,G(r.value,P=>(u(),c("option",{value:P.id,key:P.id},p(P.name),9,Cs))),128))],544),[[ye,a.value]]),U(e("input",{"onUpdate:modelValue":o[2]||(o[2]=P=>x.value=P),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[L,x.value]]),U(e("input",{"onUpdate:modelValue":o[3]||(o[3]=P=>I.value=P),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[L,I.value]]),U(e("input",{"onUpdate:modelValue":o[4]||(o[4]=P=>D.value=P),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[L,D.value]]),e("button",{class:"btn",onClick:M},[...o[8]||(o[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",Ms,[e("table",xs,[o[11]||(o[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(q,null,G(l.value,P=>(u(),c("tr",{key:P.id},[e("td",null,[U(e("input",{"onUpdate:modelValue":K=>P.title=K,onBlur:K=>R(P),class:"table-input"},null,40,Bs),[[L,P.title]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":K=>P.url=K,onBlur:K=>R(P),class:"table-input"},null,40,Us),[[L,P.url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":K=>P.logo_url=K,onBlur:K=>R(P),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Vs),[[L,P.logo_url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":K=>P.desc=K,onBlur:K=>R(P),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,As),[[L,P.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:K=>Z(P)},[P.tags&&P.tags.length>0?(u(),c("div",Ds,[(u(!0),c(q,null,G(P.tags,K=>(u(),c("span",{key:K.id,class:"mini-tag",style:we({backgroundColor:K.color})},p(K.name),5))),128))])):(u(),c("span",Is,"é€‰æ‹©æ ‡ç­¾"))],8,Ts)]),e("td",null,[U(e("input",{"onUpdate:modelValue":K=>P.order=K,type:"number",onBlur:K=>R(P),class:"table-input order-input"},null,40,Ss),[[L,P.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:K=>Y(P.id),title:"åˆ é™¤"},[...o[10]||(o[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Ls)])]))),128))])])]),h.value?(u(),c("div",{key:0,class:"modal-overlay",onClick:ee},[e("div",{class:"modal-content",onClick:o[5]||(o[5]=Me(()=>{},["stop"]))},[e("div",{class:"modal-header"},[o[12]||(o[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:ee},"Ã—")]),e("div",Ps,[v.value.length===0?(u(),c("div",Ws,[...o[13]||(o[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(u(),c("div",Ns,[(u(!0),c(q,null,G(v.value,P=>(u(),c("label",{key:P.id,class:"tag-option"},[e("input",{type:"checkbox",checked:g.value.includes(P.id),onChange:K=>se(P.id)},null,40,Ks),e("span",{class:"tag-label",style:we({backgroundColor:P.color})},p(P.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:ee},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:H},"ç¡®å®š")])])])):N("",!0),d.value?(u(),c("div",{key:1,class:"modal-overlay",onClick:W},[e("div",{class:"modal-content duplicate-modal",onClick:o[6]||(o[6]=Me(()=>{},["stop"]))},[e("div",{class:"modal-header"},[o[14]||(o[14]=de('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:W},"Ã—")]),e("div",zs,[o[24]||(o[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",Es,[e("div",Rs,[o[18]||(o[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",Os,[e("div",Hs,[o[15]||(o[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Fs,p((ae=f.value)==null?void 0:ae.title),1)]),e("div",qs,[o[16]||(o[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",Gs,p((ue=f.value)==null?void 0:ue.url),1)]),(ce=f.value)!=null&&ce.logo_url?(u(),c("div",js,[o[17]||(o[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Js,p((ve=f.value)==null?void 0:ve.logo_url),1)])):N("",!0)])]),o[23]||(o[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",Qs,[o[22]||(o[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",Xs,[e("div",Ys,[o[19]||(o[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Zs,p((Q=i.value)==null?void 0:Q.title),1)]),e("div",ea,[o[20]||(o[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",ta,p((pe=i.value)==null?void 0:pe.url),1)]),(me=i.value)!=null&&me.logo_url?(u(),c("div",sa,[o[21]||(o[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",aa,p((te=i.value)==null?void 0:te.logo_url),1)])):N("",!0)])])]),o[25]||(o[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:w},[...o[26]||(o[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),z(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:V},[...o[27]||(o[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),z(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:S},[...o[28]||(o[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),z(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):N("",!0)])}}},oa=X(la,[["__scopeId","data-v-edd548d5"]]),na={class:"duplicate-manage"},ia={class:"section-header"},ra=["disabled"],da={key:0,class:"duplicate-results"},ua={class:"result-summary"},ca={class:"summary-card"},va={class:"summary-value"},pa={class:"summary-card warning"},ma={class:"summary-value"},ga={class:"summary-card danger"},ba={class:"summary-value"},fa={class:"duplicate-groups"},ha={class:"group-header"},ya={class:"group-count"},wa={class:"card-item original"},ka={class:"card-info"},_a={class:"card-title"},$a={class:"card-url"},Ca={key:0,class:"card-desc"},Ma={class:"card-id"},xa={class:"duplicates-list"},Ba={class:"card-info"},Ua={class:"card-title"},Va={class:"card-url"},Aa={key:0,class:"card-desc"},Ta={class:"card-actions"},Da={class:"card-id"},Ia=["onClick","disabled"],Sa={class:"group-actions"},La=["onClick","disabled"],Pa={class:"global-actions"},Wa=["disabled"],Na={key:1,class:"no-duplicates"},Ka={key:2,class:"initial-hint"},za={key:3,class:"error"},Ea={__name:"DuplicateManage",setup(b){const t=k(!1),l=k(!1),T=k(!1),a=k([]),x=k(0),I=k(0),D=k("");function v(){return A(this,null,function*(){var d,f;t.value=!0,D.value="";try{const i=yield ot();x.value=i.data.total,a.value=i.data.duplicateGroups,I.value=i.data.duplicateCount,T.value=!0}catch(i){D.value=((f=(d=i.response)==null?void 0:d.data)==null?void 0:f.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",i)}finally{t.value=!1}})}function h(d){return A(this,null,function*(){var f,i,r;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){l.value=!0,D.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",d);const n=yield $e([d]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",n.data),n.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield v()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(n.data.message||"æœªçŸ¥é”™è¯¯")}catch(n){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",n),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(f=n.response)==null?void 0:f.data),D.value=((r=(i=n.response)==null?void 0:i.data)==null?void 0:r.error)||n.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}function y(d){return A(this,null,function*(){var i,r,n;const f=d.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${f} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${d.original.title}`)){l.value=!0,D.value="";try{const B=d.duplicates.map(M=>M.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",B);const C=yield $e(B);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",C.data),C.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield v()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(C.data.message||"æœªçŸ¥é”™è¯¯")}catch(B){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",B),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(i=B.response)==null?void 0:i.data),D.value=((n=(r=B.response)==null?void 0:r.data)==null?void 0:n.error)||B.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}function g(){return A(this,null,function*(){var f,i,r;const d=I.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${d} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){l.value=!0,D.value="";try{const n=a.value.flatMap(C=>C.duplicates.map(M=>M.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",n);const B=yield $e(n);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",B.data),B.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield v()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(B.data.message||"æœªçŸ¥é”™è¯¯")}catch(n){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",n),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(f=n.response)==null?void 0:f.data),D.value=((r=(i=n.response)==null?void 0:i.data)==null?void 0:r.error)||n.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}return(d,f)=>(u(),c("div",na,[e("div",ia,[f[0]||(f[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:v,class:"btn btn-primary",disabled:t.value},p(t.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,ra)]),a.value.length>0?(u(),c("div",da,[e("div",ua,[e("div",ca,[f[1]||(f[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",va,p(x.value),1)]),e("div",pa,[f[2]||(f[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",ma,p(a.value.length),1)]),e("div",ga,[f[3]||(f[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",ba,p(I.value),1)])]),e("div",fa,[(u(!0),c(q,null,G(a.value,(i,r)=>(u(),c("div",{key:r,class:"duplicate-group"},[e("div",ha,[e("h4",null,"é‡å¤ç»„ "+p(r+1),1),e("span",ya,p(i.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",wa,[f[4]||(f[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",ka,[e("div",_a,p(i.original.title),1),e("div",$a,p(i.original.url),1),i.original.desc?(u(),c("div",Ca,p(i.original.desc),1)):N("",!0)]),e("div",Ma,"ID: "+p(i.original.id),1)]),e("div",xa,[(u(!0),c(q,null,G(i.duplicates,n=>(u(),c("div",{key:n.id,class:"card-item duplicate"},[f[5]||(f[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",Ba,[e("div",Ua,p(n.title),1),e("div",Va,p(n.url),1),n.desc?(u(),c("div",Aa,p(n.desc),1)):N("",!0)]),e("div",Ta,[e("span",Da,"ID: "+p(n.id),1),e("button",{onClick:B=>h(n.id),class:"btn-remove",disabled:l.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,Ia)])]))),128))]),e("div",Sa,[e("button",{onClick:n=>y(i),class:"btn btn-danger",disabled:l.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+p(i.duplicates.length)+" å¼ ) ",9,La)])]))),128))]),e("div",Pa,[e("button",{onClick:g,class:"btn btn-danger btn-large",disabled:l.value},p(l.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${I.value} å¼ )`),9,Wa)])])):T.value&&a.value.length===0?(u(),c("div",Na,[...f[6]||(f[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):T.value?N("",!0):(u(),c("div",Ka,[...f[7]||(f[7]=[de('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),D.value?(u(),c("p",za,p(D.value),1)):N("",!0)]))}},Ra=X(Ea,[["__scopeId","data-v-62bbc778"]]),Oa={class:"tag-manage"},Ha={class:"tag-header"},Fa={class:"tag-add"},qa={class:"tag-content"},Ga={key:0,class:"empty-state"},ja={key:1,class:"tag-list"},Ja={class:"tag-info"},Qa=["onUpdate:modelValue","onBlur"],Xa={class:"tag-stats"},Ya={class:"card-count"},Za={class:"tag-controls"},el=["onUpdate:modelValue","onChange"],tl={class:"tag-order"},sl=["onUpdate:modelValue","onBlur"],al={class:"tag-actions"},ll=["onClick"],ol={__name:"TagManage",setup(b){const t=k([]),l=k(""),T=k("#2566d8");oe(a);function a(){return A(this,null,function*(){const v=yield Le();t.value=v.data;for(const h of t.value)try{const y=yield nt(h.id);h.cardCount=y.data.count}catch(y){h.cardCount=0}})}function x(){return A(this,null,function*(){var d,f;if(!l.value.trim())return;const v=t.value.length?Math.max(...t.value.map(i=>i.order||0)):0,h=l.value.trim(),y=T.value,g={id:Date.now(),name:h,color:y,order:v+1,cardCount:0,_temp:!0};t.value.push(g),l.value="",T.value="#2566d8";try{const i=yield it({name:h,color:y,order:v+1}),r=t.value.findIndex(n=>n.id===g.id);r>-1&&(t.value[r]=ke(be({},i.data),{cardCount:0}))}catch(i){const r=t.value.findIndex(n=>n.id===g.id);r>-1&&t.value.splice(r,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((f=(d=i.response)==null?void 0:d.data)==null?void 0:f.error)||i.message))}})}function I(v){return A(this,null,function*(){var h,y;if(!v._temp)try{yield rt(v.id,{name:v.name,color:v.color,order:v.order})}catch(g){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((y=(h=g.response)==null?void 0:h.data)==null?void 0:y.error)||g.message)),a()}})}function D(v){return A(this,null,function*(){var d,f;const h=t.value.find(i=>i.id===v);if(!h)return;const y=h.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${h.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${h.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${h.name}"å—ï¼Ÿ`;if(!confirm(y))return;const g=t.value.findIndex(i=>i.id===v);g>-1&&t.value.splice(g,1);try{yield dt(v)}catch(i){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((f=(d=i.response)==null?void 0:d.data)==null?void 0:f.error)||i.message)),a()}})}return(v,h)=>(u(),c("div",Oa,[e("div",Ha,[h[3]||(h[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",Fa,[U(e("input",{"onUpdate:modelValue":h[0]||(h[0]=y=>l.value=y),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[L,l.value]]),U(e("input",{"onUpdate:modelValue":h[1]||(h[1]=y=>T.value=y),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[L,T.value]]),e("button",{class:"btn btn-primary",onClick:x},[...h[2]||(h[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",qa,[t.value.length===0?(u(),c("div",Ga,[...h[4]||(h[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(u(),c("div",ja,[(u(!0),c(q,null,G(t.value,y=>(u(),c("div",{key:y.id,class:"tag-item"},[e("div",{class:"tag-preview",style:we({backgroundColor:y.color})},[...h[5]||(h[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",Ja,[U(e("input",{"onUpdate:modelValue":g=>y.name=g,onBlur:g=>I(y),class:"tag-name-input",maxlength:"20"},null,40,Qa),[[L,y.name]]),e("div",Xa,[e("span",Ya,p(y.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",Za,[U(e("input",{"onUpdate:modelValue":g=>y.color=g,type:"color",onChange:g=>I(y),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,el),[[L,y.color]]),e("div",tl,[h[6]||(h[6]=e("span",{class:"order-label"},"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":g=>y.order=g,type:"number",onBlur:g=>I(y),class:"order-input"},null,40,sl),[[L,y.order,void 0,{number:!0}]])])]),e("div",al,[e("button",{class:"btn btn-danger btn-icon",onClick:g=>D(y.id),title:"åˆ é™¤æ ‡ç­¾"},[...h[7]||(h[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,ll)])]))),128))]))])]))}},nl=X(ol,[["__scopeId","data-v-56efcb56"]]),il={class:"promo-manage"},rl={key:0,class:"loading-overlay"},dl={class:"promo-header"},ul={class:"promo-form"},cl=["disabled"],vl={class:"promo-section"},pl={class:"promo-list"},ml={key:0,class:"empty-state"},gl={class:"promo-preview"},bl=["src"],fl={class:"promo-info"},hl={class:"promo-field"},yl=["onUpdate:modelValue","onBlur"],wl={class:"promo-field"},kl=["onUpdate:modelValue","onBlur"],_l={class:"promo-actions"},$l=["onClick"],Cl={class:"promo-section"},Ml={class:"promo-list"},xl={key:0,class:"empty-state"},Bl={class:"promo-preview"},Ul=["src"],Vl={class:"promo-info"},Al={class:"promo-field"},Tl=["onUpdate:modelValue","onBlur"],Dl={class:"promo-field"},Il=["onUpdate:modelValue","onBlur"],Sl={class:"promo-actions"},Ll=["onClick"],fe="/api",Pl={__name:"PromoManage",setup(b){const t=()=>localStorage.getItem("token")||"",l=()=>({Authorization:`Bearer ${t()}`}),T=k([]),a=k(!1),x=k("åŠ è½½ä¸­..."),I=k({img:"",url:"",position:"left"}),D=re(()=>T.value.filter(i=>i.position==="left")),v=re(()=>T.value.filter(i=>i.position==="right"));oe(()=>{h()});function h(){return A(this,null,function*(){var i,r;a.value=!0,x.value="åŠ è½½ä¸­...";try{const n=yield ie.get(`${fe}/promos`);let B=[];Array.isArray(n.data)?B=n.data:n.data&&Array.isArray(n.data.data)&&(B=n.data.data),T.value=B}catch(n){console.error("åŠ è½½å®£ä¼ å¤±è´¥:",n),alert("åŠ è½½å®£ä¼ å¤±è´¥: "+(((r=(i=n.response)==null?void 0:i.data)==null?void 0:r.error)||n.message))}finally{a.value=!1}})}function y(){return A(this,null,function*(){var i,r;if(!I.value.img||!I.value.url){alert("è¯·å¡«å†™å®£ä¼ å›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}a.value=!0,x.value="æ·»åŠ ä¸­...";try{yield ie.post(`${fe}/promos`,I.value,{headers:l()}),I.value={img:"",url:"",position:"left"},yield h()}catch(n){alert("æ·»åŠ å¤±è´¥: "+(((r=(i=n.response)==null?void 0:i.data)==null?void 0:r.error)||n.message)),a.value=!1}})}function g(i){return A(this,null,function*(){var r,n;try{yield ie.put(`${fe}/promos/${i.id}`,{img:i.img,url:i.url},{headers:l()})}catch(B){alert("æ›´æ–°å¤±è´¥: "+(((n=(r=B.response)==null?void 0:r.data)==null?void 0:n.error)||B.message)),yield h()}})}function d(i){return A(this,null,function*(){var r,n;if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªå®£ä¼ å—ï¼Ÿ")){a.value=!0,x.value="åˆ é™¤ä¸­...";try{yield ie.delete(`${fe}/promos/${i.id}`,{headers:l()}),yield h()}catch(B){alert("åˆ é™¤å¤±è´¥: "+(((n=(r=B.response)==null?void 0:r.data)==null?void 0:n.error)||B.message)),a.value=!1}}})}function f(i){i.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="60"><rect fill="%23f0f0f0" width="100" height="60"/><text x="50" y="35" text-anchor="middle" fill="%23999" font-size="12">å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'}return(i,r)=>(u(),c("div",il,[a.value?(u(),c("div",rl,[r[3]||(r[3]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,p(x.value),1)])):N("",!0),e("div",dl,[r[5]||(r[5]=e("h2",{class:"page-title"},"å®£ä¼ ç®¡ç†",-1)),e("div",ul,[U(e("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>I.value.img=n),placeholder:"å®£ä¼ å›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[L,I.value.img]]),U(e("input",{"onUpdate:modelValue":r[1]||(r[1]=n=>I.value.url=n),placeholder:"å®£ä¼ è·³è½¬é“¾æ¥",class:"input"},null,512),[[L,I.value.url]]),U(e("select",{"onUpdate:modelValue":r[2]||(r[2]=n=>I.value.position=n),class:"input select"},[...r[4]||(r[4]=[e("option",{value:"left"},"å·¦ä¾§å®£ä¼ ",-1),e("option",{value:"right"},"å³ä¾§å®£ä¼ ",-1)])],512),[[ye,I.value.position]]),e("button",{class:"btn btn-primary",onClick:y,disabled:!I.value.img||!I.value.url}," + æ·»åŠ å®£ä¼  ",8,cl)])]),e("div",vl,[r[8]||(r[8]=e("h3",{class:"section-title"},"ğŸ“ å·¦ä¾§å®£ä¼ ",-1)),e("div",pl,[D.value.length===0?(u(),c("div",ml,"æš‚æ— å·¦ä¾§å®£ä¼ ")):N("",!0),(u(!0),c(q,null,G(D.value,n=>(u(),c("div",{key:n.id,class:"promo-card"},[e("div",gl,[e("img",{src:n.img,alt:"å®£ä¼ å›¾ç‰‡",onError:f},null,40,bl)]),e("div",fl,[e("div",hl,[r[6]||(r[6]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":B=>n.img=B,class:"input",onBlur:B=>g(n)},null,40,yl),[[L,n.img]])]),e("div",wl,[r[7]||(r[7]=e("label",null,"è·³è½¬é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":B=>n.url=B,class:"input",onBlur:B=>g(n)},null,40,kl),[[L,n.url]])])]),e("div",_l,[e("button",{class:"btn btn-danger",onClick:B=>d(n)},"åˆ é™¤",8,$l)])]))),128))])]),e("div",Cl,[r[11]||(r[11]=e("h3",{class:"section-title"},"ğŸ“ å³ä¾§å®£ä¼ ",-1)),e("div",Ml,[v.value.length===0?(u(),c("div",xl,"æš‚æ— å³ä¾§å®£ä¼ ")):N("",!0),(u(!0),c(q,null,G(v.value,n=>(u(),c("div",{key:n.id,class:"promo-card"},[e("div",Bl,[e("img",{src:n.img,alt:"å®£ä¼ å›¾ç‰‡",onError:f},null,40,Ul)]),e("div",Vl,[e("div",Al,[r[9]||(r[9]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":B=>n.img=B,class:"input",onBlur:B=>g(n)},null,40,Tl),[[L,n.img]])]),e("div",Dl,[r[10]||(r[10]=e("label",null,"è·³è½¬é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":B=>n.url=B,class:"input",onBlur:B=>g(n)},null,40,Il),[[L,n.url]])])]),e("div",Sl,[e("button",{class:"btn btn-danger",onClick:B=>d(n)},"åˆ é™¤",8,Ll)])]))),128))])])]))}},Wl=X(Pl,[["__scopeId","data-v-0221fbc3"]]),Nl={class:"friend-manage"},Kl={class:"friend-add"},zl={class:"friend-card"},El={class:"friend-table"},Rl=["onUpdate:modelValue","onBlur"],Ol=["onUpdate:modelValue","onBlur"],Hl=["onUpdate:modelValue","onBlur"],Fl=["onClick"],ql={__name:"FriendLinkManage",setup(b){const t=k([]),l=k(""),T=k(""),a=k("");oe(x);function x(){return A(this,null,function*(){const h=yield ut();t.value=h.data})}function I(){return A(this,null,function*(){!l.value||!T.value||(yield ct({title:l.value,url:T.value,logo:a.value}),l.value="",T.value="",a.value="",x())})}function D(h){return A(this,null,function*(){yield vt(h.id,{title:h.title,url:h.url,logo:h.logo}),x()})}function v(h){return A(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const y=t.value.findIndex(g=>g.id===h);y>-1&&t.value.splice(y,1);try{yield pt(h)}catch(g){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",g),yield x()}})}return(h,y)=>(u(),c("div",Nl,[y[4]||(y[4]=e("div",{class:"friend-header"},null,-1)),e("div",Kl,[U(e("input",{"onUpdate:modelValue":y[0]||(y[0]=g=>l.value=g),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[L,l.value]]),U(e("input",{"onUpdate:modelValue":y[1]||(y[1]=g=>T.value=g),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[L,T.value]]),U(e("input",{"onUpdate:modelValue":y[2]||(y[2]=g=>a.value=g),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[L,a.value]]),e("button",{class:"btn",onClick:I},"æ·»åŠ å‹é“¾")]),e("div",zl,[e("table",El,[y[3]||(y[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(q,null,G(t.value,g=>(u(),c("tr",{key:g.id},[e("td",null,[U(e("input",{"onUpdate:modelValue":d=>g.title=d,onBlur:d=>D(g),class:"input"},null,40,Rl),[[L,g.title]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":d=>g.url=d,onBlur:d=>D(g),class:"input"},null,40,Ol),[[L,g.url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":d=>g.logo=d,onBlur:d=>D(g),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Hl),[[L,g.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:d=>v(g.id)},"åˆ é™¤",8,Fl)])]))),128))])])])]))}},Gl=X(ql,[["__scopeId","data-v-c25e838c"]]),jl={class:"user-manage"},Jl={class:"user-card"},Ql={class:"username-section"},Xl={class:"username-form"},Yl={class:"current-username"},Zl={class:"username-display"},eo={class:"form-group"},to={class:"form-actions"},so=["disabled"],ao={class:"password-section"},lo={class:"password-form"},oo={class:"form-group"},no={class:"form-group"},io={class:"form-group"},ro={class:"form-actions"},uo=["disabled"],co={__name:"UserManage",setup(b){const t=k(""),l=k(""),T=k(""),a=k(!1),x=k(""),I=k("success"),D=k({}),v=k(""),h=k(!1),y=k(""),g=k("success");oe(()=>A(null,null,function*(){yield d()}));function d(){return A(this,null,function*(){try{const B=yield mt();D.value=B.data.data||B.data}catch(B){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",B)}})}function f(){return A(this,null,function*(){var B,C;if(!v.value){i("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(v.value.length<3||v.value.length>20){i("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(v.value===D.value.username){i("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}h.value=!0,y.value="";try{yield gt(v.value),i("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),v.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(M){i(((C=(B=M.response)==null?void 0:B.data)==null?void 0:C.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{h.value=!1}})}function i(B,C){y.value=B,g.value=C,setTimeout(()=>{y.value=""},3e3)}function r(){return A(this,null,function*(){var B,C;if(!t.value||!l.value||!T.value){n("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(l.value!==T.value){n("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(l.value.length<6){n("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}a.value=!0,x.value="";try{yield bt(t.value,l.value),n("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),t.value="",l.value="",T.value=""}catch(M){n(((C=(B=M.response)==null?void 0:B.data)==null?void 0:C.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{a.value=!1}})}function n(B,C){x.value=B,I.value=C,B==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&C==="success"?setTimeout(()=>{x.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{x.value=""},3e3)}return(B,C)=>(u(),c("div",jl,[C[11]||(C[11]=e("div",{class:"user-header"},null,-1)),e("div",Jl,[e("div",Ql,[C[6]||(C[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",Xl,[e("div",Yl,[C[4]||(C[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",Zl,p(D.value.username||"admin"),1)]),e("div",eo,[C[5]||(C[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[0]||(C[0]=M=>v.value=M),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[L,v.value]])]),e("div",to,[e("button",{onClick:f,class:"btn",disabled:h.value},p(h.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,so)]),y.value?(u(),c("p",{key:0,class:E(["message",g.value])},p(y.value),3)):N("",!0)])]),e("div",ao,[C[10]||(C[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",lo,[e("div",oo,[C[7]||(C[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[1]||(C[1]=M=>t.value=M),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[L,t.value]])]),e("div",no,[C[8]||(C[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[2]||(C[2]=M=>l.value=M),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,l.value]])]),e("div",io,[C[9]||(C[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[3]||(C[3]=M=>T.value=M),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,T.value]])]),e("div",ro,[e("button",{onClick:r,class:"btn",disabled:a.value},p(a.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,uo)]),x.value?(u(),c("p",{key:0,class:E(["message",I.value])},p(x.value),3)):N("",!0)])])])]))}},vo=X(co,[["__scopeId","data-v-40392133"]]),po={class:"backup-manage"},mo={class:"tabs"},go={class:"tab-content"},bo={class:"toolbar"},fo=["disabled"],ho=["disabled"],yo=["disabled"],wo={class:"backup-list"},ko={key:0,class:"empty-state"},_o={key:1,class:"backup-grid"},$o={class:"backup-info"},Co={class:"backup-name"},Mo={class:"backup-meta"},xo={class:"backup-size"},Bo={class:"backup-date"},Uo={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Vo={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},Ao={class:"backup-actions"},To=["onClick"],Do=["onClick"],Io=["onClick"],So=["onClick"],Lo={class:"tab-content"},Po={class:"toolbar"},Wo=["disabled"],No=["disabled"],Ko={key:1,class:"info-box"},zo={class:"backup-list"},Eo={key:0,class:"empty-state"},Ro={key:1,class:"backup-grid"},Oo={class:"backup-info"},Ho={class:"backup-name"},Fo={class:"backup-meta"},qo={class:"backup-size"},Go={class:"backup-date"},jo={class:"backup-actions"},Jo=["onClick"],Qo=["onClick"],Xo={class:"tab-content"},Yo={class:"config-section"},Zo={class:"config-card"},en={class:"config-header"},tn={class:"switch"},sn={key:0,class:"config-fields"},an={class:"field-row"},ln={class:"field-row"},on={class:"config-card"},nn={class:"config-header"},rn={class:"switch"},dn={key:0,class:"config-fields"},un={class:"field-row"},cn={class:"time-input"},vn={class:"field-row"},pn={class:"field-row checkbox-row"},mn={class:"checkbox-label"},gn={class:"config-card"},bn={class:"config-header"},fn={class:"switch"},hn={class:"config-info"},yn={key:0,class:"warning-text"},wn={key:0,class:"config-fields"},kn={class:"field-row checkbox-row"},_n={class:"checkbox-label"},$n={class:"field-row checkbox-row"},Cn={class:"checkbox-label"},Mn={class:"config-card"},xn={class:"config-header"},Bn={class:"switch"},Un={key:0,class:"stats-card"},Vn={class:"stats-grid"},An={class:"stat-item"},Tn={class:"stat-value"},Dn={class:"stat-item"},In={class:"stat-value"},Sn={class:"stat-item"},Ln={class:"stat-value"},Pn={class:"stat-item"},Wn={class:"stat-value"},Nn={class:"config-actions"},Kn=["disabled"],zn={key:0,class:"modal-overlay"},En={class:"modal-content config-modal"},Rn={class:"form-group"},On={class:"form-group"},Hn={class:"form-group"},Fn=["placeholder"],qn={key:0},Gn={key:1},jn={class:"modal-actions"},Jn=["disabled"],Qn={key:1,class:"modal-overlay"},Xn={class:"modal-content"},Yn={style:{"white-space":"pre-line"}},Zn={class:"modal-actions"},ei=["disabled"],ti=["disabled"],si={key:2,class:"modal-overlay"},ai={class:"modal-content config-modal"},li={class:"form-group"},oi={class:"form-group"},ni={class:"modal-actions"},ii=["disabled"],ri={key:3,class:"modal-overlay"},di={class:"modal-content config-modal"},ui={class:"form-group"},ci={class:"modal-actions"},vi=["disabled"],pi={__name:"BackupManage",setup(b){const t=k("local"),l=k([]),T=k([]),a=k(!1),x=k(!1),I=k(!1),D=k(null),v=ne({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),h=ne({name:"",description:""}),y=ne({oldName:"",newName:""}),g=k({text:"",type:""}),d=ne({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),f=ne({configured:!1,url:"",username:""}),i=ne({url:"",username:"",password:""}),r=ne({debounce:{enabled:!0,delay:5,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),n=k(null),B=localStorage.getItem("token");function C(F){return A(this,arguments,function*($,s={}){return(yield fetch($,ke(be({},s),{headers:be({Authorization:`Bearer ${B}`,"Content-Type":"application/json"},s.headers)}))).json()})}const M=($,s="success",F=4e3)=>{g.value={text:$,type:s},setTimeout(()=>{g.value={text:"",type:""}},s==="error"?6e3:F)};function R(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[å¤‡ä»½ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch($){console.warn("[å¤‡ä»½ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",$)}}const Y=()=>{h.name="",h.description="",x.value=!0},Z=()=>A(null,null,function*(){v.create=!0;const $=yield C("/api/backup/create",{method:"POST",body:JSON.stringify({name:h.name||null,description:h.description||null})});$.success?(M("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),x.value=!1,yield H()):M($.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),v.create=!1}),ee=$=>{y.oldName=$,y.newName=$.replace(".zip",""),I.value=!0},se=()=>A(null,null,function*(){if(!y.newName.trim()){M("è¯·è¾“å…¥æ–°åç§°","error");return}v.rename=!0;const $=yield C(`/api/backup/rename/${y.oldName}`,{method:"PUT",body:JSON.stringify({newName:y.newName})});$.success?(M("é‡å‘½åæˆåŠŸï¼"),I.value=!1,yield H()):M($.message||"é‡å‘½åå¤±è´¥","error"),v.rename=!1}),H=()=>A(null,null,function*(){v.list=!0;const $=yield C("/api/backup/list");$.success?l.value=$.backups:M("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),v.list=!1}),O=$=>{window.open(`/api/backup/download/${$}?token=${B}`,"_blank")},W=($,s)=>{const F=typeof s=="object"?s:{name:s},_=F.name;d.show=!0,d.filename=_,d.action=$,d.signed=F.signed,d.processing=!1,$==="delete"?(d.title="åˆ é™¤",d.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${_} å—ï¼Ÿ`,d.confirmClass="btn-danger"):$==="restore"?(d.title="æ¢å¤",F.signed?d.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${_} å—ï¼Ÿ`:d.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${_} å—ï¼Ÿ`,d.confirmClass="btn-restore"):$==="webdav-restore"?(d.title="ä»WebDAVæ¢å¤",d.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${_} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,d.confirmClass="btn-restore"):$==="webdav-delete"&&(d.title="åˆ é™¤WebDAVå¤‡ä»½",d.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${_} å—ï¼Ÿ`,d.confirmClass="btn-danger")},w=()=>A(null,null,function*(){const{action:$,filename:s,signed:F}=d;d.show=!1,d.processing=!1;try{if($==="delete"){M("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const _=yield C(`/api/backup/delete/${s}`,{method:"DELETE"});_.success?(M("âœ“ åˆ é™¤æˆåŠŸ"),yield H()):M("âœ— "+(_.message||"åˆ é™¤å¤±è´¥"),"error")}else if($==="restore"){M("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const _=F?{}:{forceRestore:!0},j=yield C(`/api/backup/restore/${s}`,{method:"POST",body:JSON.stringify(_)});if(j.success)M("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ge=>setTimeout(ge,2e3)),yield Promise.all([H(),o(),Q(),te()]),R(),M("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(j.requireConfirm&&j.code==="NO_SIGNATURE"){if(confirm(j.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const ge=yield C(`/api/backup/restore/${s}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});ge.success?(M("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(We=>setTimeout(We,2e3)),yield Promise.all([H(),o(),Q(),te()]),R(),M("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):M("âœ— "+(ge.message||"æ¢å¤å¤±è´¥"),"error")}}else M("âœ— "+(j.message||"æ¢å¤å¤±è´¥"),"error")}else $==="webdav-restore"?yield pe(s):$==="webdav-delete"&&(yield me(s))}catch(_){M("âœ— æ“ä½œå¤±è´¥: "+_.message,"error")}}),V=$=>$?new Date($).toLocaleString("zh-CN",{hour12:!1}):"--",S=()=>{D.value.click()},m=$=>A(null,null,function*(){const s=$.target.files[0];if(s){if(!s.name.endsWith(".zip")){M("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),$.target.value="";return}if(s.size>500*1024*1024){M("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),$.target.value="";return}v.upload=!0;try{const F=new FormData;F.append("backup",s);const j=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${B}`},body:F})).json();j.success?(M("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield H()):M(j.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(F){console.error("ä¸Šä¼ å¤±è´¥:",F),M("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{v.upload=!1,$.target.value=""}}}),o=()=>A(null,null,function*(){const $=yield C("/api/backup/webdav/config");$.success&&$.config&&(f.configured=$.config.configured,f.url=$.config.url||"",f.username=$.config.username||"")}),ae=()=>A(null,null,function*(){yield o(),i.url=f.url,i.username=f.username,i.password="",a.value=!0}),ue=()=>A(null,null,function*(){if(!i.url||!i.username){M("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!f.configured&&!i.password){M("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}v.webdavConfig=!0;const $=yield C("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(i)});$.success?(a.value=!1,yield o(),f.configured?(yield Q(),yield te(),r.webdav.enabled?M("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"):(r.webdav.enabled=!0,(yield C("/api/backup/auto/config",{method:"POST",body:JSON.stringify(r)})).success?M("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œå·²è‡ªåŠ¨å¼€å¯WebDAVè‡ªåŠ¨åŒæ­¥ï¼"):M("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œä½†è‡ªåŠ¨åŒæ­¥å¼€å¯å¤±è´¥","error"))):M("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼")):M($.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),v.webdavConfig=!1}),ce=()=>A(null,null,function*(){v.webdavBackup=!0;const $=yield C("/api/backup/webdav/backup",{method:"POST"});$.success?(M("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield Q()):(M($.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),$.needReconfigure&&(f.configured=!1,f.url="",f.username="")),v.webdavBackup=!1}),ve=$=>{$.target.checked&&!f.configured&&(r.webdav.enabled=!1,M('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),t.value="webdav")},Q=()=>A(null,null,function*(){v.webdavList=!0;const $=yield C("/api/backup/webdav/list");$.success?(T.value=$.backups||[],$.configured===!1&&(f.configured=!1,f.url="",f.username="",$.message&&M($.message,"error"))):M($.message||"è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),v.webdavList=!1}),pe=$=>A(null,null,function*(){M("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),v.webdavRestore=!0;try{const s=yield C("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:$})});s.success?(M("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(F=>setTimeout(F,2e3)),yield Promise.all([H(),o(),Q(),te()]),R(),M("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):(M("âœ— "+(s.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error"),s.needReconfigure&&(f.configured=!1,f.url="",f.username=""))}catch(s){M("âœ— æ¢å¤å¤±è´¥: "+s.message,"error")}finally{v.webdavRestore=!1}}),me=$=>A(null,null,function*(){M("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),v.webdavDelete=!0;try{const s=yield C(`/api/backup/webdav/delete/${$}`,{method:"DELETE"});s.success?(M("âœ“ åˆ é™¤æˆåŠŸ"),yield Q()):(M("âœ— "+(s.message||"åˆ é™¤å¤±è´¥"),"error"),s.needReconfigure&&(f.configured=!1,f.url="",f.username=""))}catch(s){M("âœ— åˆ é™¤å¤±è´¥: "+s.message,"error")}finally{v.webdavDelete=!1}}),te=()=>A(null,null,function*(){const $=yield C("/api/backup/auto/config");$.success&&$.config?(Object.assign(r,$.config),n.value=$.stats||null):M("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),P=()=>A(null,null,function*(){v.autoBackupConfig=!0;const $=yield C("/api/backup/auto/config",{method:"POST",body:JSON.stringify(r)});$.success?(M("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield te()):M($.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),v.autoBackupConfig=!1}),K=()=>{if(!r.scheduled.enabled)return"æœªå¯ç”¨";const $=String(r.scheduled.hour).padStart(2,"0"),s=String(r.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${$}:${s}`},Pe=()=>{confirm("ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é…ç½®å—ï¼Ÿè¿™å°†é‡ç½®æ‰€æœ‰è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚")&&(r.debounce={enabled:!0,delay:5,keep:5},r.scheduled={enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},r.webdav={enabled:!1,syncDaily:!0,syncIncremental:!0},r.autoClean=!0,M('å·²æ¢å¤é»˜è®¤é…ç½®ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"ä»¥ç”Ÿæ•ˆ'))};return oe(()=>A(null,null,function*(){yield H(),yield o(),f.configured&&(yield Q()),yield te()})),($,s)=>{var F;return u(),c("div",po,[e("div",mo,[e("button",{class:E(["tab",{active:t.value==="local"}]),onClick:s[0]||(s[0]=_=>t.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:E(["tab",{active:t.value==="webdav"}]),onClick:s[1]||(s[1]=_=>t.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:E(["tab",{active:t.value==="auto"}]),onClick:s[2]||(s[2]=_=>t.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),U(e("div",go,[e("div",bo,[e("button",{class:"btn btn-primary",onClick:Y,disabled:v.create},[s[25]||(s[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+p(v.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,fo),e("button",{class:"btn btn-success",onClick:S,disabled:v.upload},[s[26]||(s[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),z(" "+p(v.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,ho),e("button",{class:"btn btn-secondary",onClick:H,disabled:v.list},[s[27]||(s[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+p(v.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,yo),e("input",{ref_key:"fileInput",ref:D,type:"file",accept:".zip",onChange:m,style:{display:"none"}},null,544)]),g.value.text?(u(),c("div",{key:0,class:E(["message",g.value.type])},p(g.value.text),3)):N("",!0),e("div",wo,[l.value.length===0&&!v.list?(u(),c("div",ko,[...s[28]||(s[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(u(),c("div",_o,[(u(!0),c(q,null,G(l.value,_=>(u(),c("div",{key:_.name,class:"backup-card"},[s[33]||(s[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",$o,[e("div",Co,p(_.name),1),e("div",Mo,[e("span",xo,p(_.size),1),e("span",Bo,p(V(_.created)),1),_.signed?(u(),c("span",Uo,"ğŸ”’")):(u(),c("span",Vo,"âš ï¸"))])]),e("div",Ao,[e("button",{class:"btn-icon btn-restore",onClick:j=>W("restore",_),title:"æ¢å¤å¤‡ä»½"},[...s[29]||(s[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,To),e("button",{class:"btn-icon btn-rename",onClick:j=>ee(_.name),title:"é‡å‘½å"},[...s[30]||(s[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Do),e("button",{class:"btn-icon",onClick:j=>O(_.name),title:"ä¸‹è½½å¤‡ä»½"},[...s[31]||(s[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Io),e("button",{class:"btn-icon btn-danger",onClick:j=>W("delete",_.name),title:"åˆ é™¤å¤‡ä»½"},[...s[32]||(s[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,So)])]))),128))]))])],512),[[_e,t.value==="local"]]),U(e("div",Lo,[e("div",Po,[e("button",{class:"btn btn-primary",onClick:ae},[...s[34]||(s[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),z(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ce,disabled:v.webdavBackup||!f.configured},[s[35]||(s[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+p(v.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Wo),e("button",{class:"btn btn-secondary",onClick:Q,disabled:v.webdavList||!f.configured},[s[36]||(s[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+p(v.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,No)]),g.value.text?(u(),c("div",{key:0,class:E(["message",g.value.type])},p(g.value.text),3)):N("",!0),f.configured?N("",!0):(u(),c("div",Ko,[...s[37]||(s[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",zo,[T.value.length===0&&!v.webdavList?(u(),c("div",Eo,[...s[38]||(s[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(u(),c("div",Ro,[(u(!0),c(q,null,G(T.value,_=>(u(),c("div",{key:_.name,class:"backup-card"},[s[41]||(s[41]=de('<div class="backup-icon" data-v-23e75a45><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-23e75a45><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-23e75a45></path><polyline points="14 2 14 8 20 8" data-v-23e75a45></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-23e75a45></path></svg></div>',1)),e("div",Oo,[e("div",Ho,p(_.name),1),e("div",Fo,[e("span",qo,p(_.size),1),e("span",Go,p(V(_.created)),1)])]),e("div",jo,[e("button",{class:"btn-icon btn-restore",onClick:j=>W("webdav-restore",_.name),title:"ä»WebDAVæ¢å¤"},[...s[39]||(s[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Jo),e("button",{class:"btn-icon btn-danger",onClick:j=>W("webdav-delete",_.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...s[40]||(s[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Qo)])]))),128))]))])],512),[[_e,t.value==="webdav"]]),U(e("div",Xo,[g.value.text?(u(),c("div",{key:0,class:E(["message",g.value.type])},p(g.value.text),3)):N("",!0),e("div",Yo,[s[76]||(s[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),s[77]||(s[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",Zo,[e("div",en,[s[43]||(s[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",tn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=_=>r.debounce.enabled=_)},null,512),[[le,r.debounce.enabled]]),s[42]||(s[42]=e("span",{class:"slider"},null,-1))])]),s[48]||(s[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),r.debounce.enabled?(u(),c("div",sn,[e("div",an,[s[44]||(s[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),U(e("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=_=>r.debounce.delay=_),min:"5",max:"1440",class:"form-input"},null,512),[[L,r.debounce.delay,void 0,{number:!0}]]),s[45]||(s[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",ln,[s[46]||(s[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),U(e("input",{type:"number","onUpdate:modelValue":s[5]||(s[5]=_=>r.debounce.keep=_),min:"1",max:"30",class:"form-input"},null,512),[[L,r.debounce.keep,void 0,{number:!0}]]),s[47]||(s[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):N("",!0)]),e("div",on,[e("div",nn,[s[50]||(s[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",rn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=_=>r.scheduled.enabled=_)},null,512),[[le,r.scheduled.enabled]]),s[49]||(s[49]=e("span",{class:"slider"},null,-1))])]),s[58]||(s[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),r.scheduled.enabled?(u(),c("div",dn,[e("div",un,[s[52]||(s[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",cn,[U(e("input",{type:"number","onUpdate:modelValue":s[7]||(s[7]=_=>r.scheduled.hour=_),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[L,r.scheduled.hour,void 0,{number:!0}]]),s[51]||(s[51]=e("span",null,":",-1)),U(e("input",{type:"number","onUpdate:modelValue":s[8]||(s[8]=_=>r.scheduled.minute=_),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[L,r.scheduled.minute,void 0,{number:!0}]])]),s[53]||(s[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",vn,[s[54]||(s[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),U(e("input",{type:"number","onUpdate:modelValue":s[9]||(s[9]=_=>r.scheduled.keep=_),min:"1",max:"30",class:"form-input"},null,512),[[L,r.scheduled.keep,void 0,{number:!0}]]),s[55]||(s[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",pn,[e("label",mn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[10]||(s[10]=_=>r.scheduled.onlyIfModified=_)},null,512),[[le,r.scheduled.onlyIfModified]]),s[56]||(s[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),s[57]||(s[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):N("",!0)]),e("div",gn,[e("div",bn,[s[60]||(s[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",fn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=_=>r.webdav.enabled=_),onChange:ve},null,544),[[le,r.webdav.enabled]]),s[59]||(s[59]=e("span",{class:"slider"},null,-1))])]),e("p",hn,[s[61]||(s[61]=z(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),f.configured?N("",!0):(u(),c("span",yn,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),r.webdav.enabled?(u(),c("div",wn,[e("div",kn,[e("label",_n,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=_=>r.webdav.syncDaily=_)},null,512),[[le,r.webdav.syncDaily]]),s[62]||(s[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),s[63]||(s[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",$n,[e("label",Cn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=_=>r.webdav.syncIncremental=_)},null,512),[[le,r.webdav.syncIncremental]]),s[64]||(s[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),s[65]||(s[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):N("",!0)]),e("div",Mn,[e("div",xn,[s[67]||(s[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Bn,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=_=>r.autoClean=_)},null,512),[[le,r.autoClean]]),s[66]||(s[66]=e("span",{class:"slider"},null,-1))])]),s[68]||(s[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),n.value?(u(),c("div",Un,[s[73]||(s[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Vn,[e("div",An,[s[69]||(s[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Tn,p(((F=n.value.incremental)==null?void 0:F.count)||0)+" ä¸ª",1)]),e("div",Dn,[s[70]||(s[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",In,p(V(n.value.lastDebounce)||"æ— "),1)]),e("div",Sn,[s[71]||(s[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Ln,p(V(n.value.lastScheduled)||"æ— "),1)]),e("div",Pn,[s[72]||(s[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",Wn,p(K()),1)])])])):N("",!0),e("div",Nn,[e("button",{class:"btn btn-secondary",onClick:Pe},[...s[74]||(s[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),z(" æ¢å¤é»˜è®¤ ",-1)])]),e("button",{class:"btn btn-primary",onClick:P,disabled:v.autoBackupConfig},[s[75]||(s[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),z(" "+p(v.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Kn)])])],512),[[_e,t.value==="auto"]]),a.value?(u(),c("div",zn,[e("div",En,[s[82]||(s[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",Rn,[s[78]||(s[78]=e("label",null,[z("WebDAV URL "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":s[15]||(s[15]=_=>i.url=_),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[L,i.url]]),s[79]||(s[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",On,[s[80]||(s[80]=e("label",null,[z("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":s[16]||(s[16]=_=>i.username=_),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[L,i.username]])]),e("div",Hn,[s[81]||(s[81]=e("label",null,[z("å¯†ç  "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"password","onUpdate:modelValue":s[17]||(s[17]=_=>i.password=_),placeholder:f.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,Fn),[[L,i.password]]),f.configured?(u(),c("small",Gn,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(u(),c("small",qn,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",jn,[e("button",{class:"btn btn-secondary",onClick:s[18]||(s[18]=_=>a.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ue,disabled:v.webdavConfig},p(v.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,Jn)])])])):N("",!0),d.show?(u(),c("div",Qn,[e("div",Xn,[e("h3",null,"ç¡®è®¤"+p(d.title),1),e("p",Yn,p(d.message),1),e("div",Zn,[e("button",{class:"btn btn-secondary",onClick:s[19]||(s[19]=_=>d.show=!1),disabled:d.processing},"å–æ¶ˆ",8,ei),e("button",{class:E(["btn",d.confirmClass]),onClick:w,disabled:d.processing},p(d.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,ti)])])])):N("",!0),x.value?(u(),c("div",si,[e("div",ai,[s[86]||(s[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",li,[s[83]||(s[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),U(e("input",{type:"text","onUpdate:modelValue":s[20]||(s[20]=_=>h.name=_),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[L,h.name]]),s[84]||(s[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",oi,[s[85]||(s[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),U(e("textarea",{"onUpdate:modelValue":s[21]||(s[21]=_=>h.description=_),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[L,h.description]])]),e("div",ni,[e("button",{class:"btn btn-secondary",onClick:s[22]||(s[22]=_=>x.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:Z,disabled:v.create},p(v.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,ii)])])])):N("",!0),I.value?(u(),c("div",ri,[e("div",di,[s[88]||(s[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",ui,[s[87]||(s[87]=e("label",null,[z("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":s[23]||(s[23]=_=>y.newName=_),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[L,y.newName]]),e("small",null,"åŸåç§°ï¼š"+p(y.oldName),1)]),e("div",ci,[e("button",{class:"btn btn-secondary",onClick:s[24]||(s[24]=_=>I.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:v.rename||!y.newName.trim()},p(v.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,vi)])])])):N("",!0)])}}},mi=X(pi,[["__scopeId","data-v-23e75a45"]]);function Te(){const b=localStorage.getItem("token");return b?{Authorization:`Bearer ${b}`}:{}}const J={get:b=>ie.get(b,{headers:Te()}),post:(b,t)=>ie.post(b,t,{headers:Te()})},he={openai:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gpt-3.5-turbo",defaultBaseUrl:"https://api.openai.com"},anthropic:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"claude-3-haiku-20240307",defaultBaseUrl:""},gemini:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gemini-1.5-flash",defaultBaseUrl:""},groq:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"llama-3.1-8b-instant",defaultBaseUrl:""},deepseek:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"deepseek-chat",defaultBaseUrl:"https://api.deepseek.com"},zhipu:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"glm-4-flash",defaultBaseUrl:""},qwen:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"qwen-turbo",defaultBaseUrl:""},doubao:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"doubao-lite-4k",defaultBaseUrl:""},moonshot:{needsApiKey:!0,needsBaseUrl:!1,defaultModel:"moonshot-v1-8k",defaultBaseUrl:""},ollama:{needsApiKey:!1,needsBaseUrl:!0,defaultModel:"llama3.2",defaultBaseUrl:"http://localhost:11434"},custom:{needsApiKey:!0,needsBaseUrl:!0,defaultModel:"",defaultBaseUrl:""}},gi={name:"AISettings",data(){return{config:{provider:"deepseek",apiKey:"",baseUrl:"",model:"",requestDelay:1500,autoGenerate:!1,hasApiKey:!1},showApiKey:!1,testing:!1,saving:!1,refreshing:!1,starting:!1,stopping:!1,stats:null,batchRunning:!1,batchType:"",batchMode:"",batchProgress:{current:0,total:0,currentCard:""},pollTimer:null,message:"",messageType:"info"}},computed:{needsApiKey(){var b,t;return(t=(b=he[this.config.provider])==null?void 0:b.needsApiKey)!=null?t:!0},needsBaseUrl(){var b,t;return(t=(b=he[this.config.provider])==null?void 0:b.needsBaseUrl)!=null?t:!1},defaultModel(){var b;return((b=he[this.config.provider])==null?void 0:b.defaultModel)||""},defaultBaseUrl(){var b;return((b=he[this.config.provider])==null?void 0:b.defaultBaseUrl)||""},progressPercent(){return this.batchProgress.total?Math.round(this.batchProgress.current/this.batchProgress.total*100):0},batchLabel(){const t={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"}[this.batchType]||"å†…å®¹";return`${this.batchMode==="all"?"é‡æ–°ç”Ÿæˆæ‰€æœ‰":"ç”Ÿæˆç¼ºå°‘çš„"}${t}`}},mounted(){return A(this,null,function*(){yield this.loadConfig(),yield this.refreshStats(),yield this.checkRunningTask()})},beforeUnmount(){this.stopPolling()},methods:{stopPolling(){this.pollTimer&&(clearTimeout(this.pollTimer),this.pollTimer=null)},loadConfig(){return A(this,null,function*(){try{const b=yield J.get("/api/ai/config");if(b.data.success){const t=b.data.config;this.config.provider=t.provider||"deepseek",this.config.hasApiKey=t.hasApiKey,this.config.baseUrl=t.baseUrl||"",this.config.model=t.model||"",this.config.requestDelay=t.requestDelay||1500,this.config.autoGenerate=t.autoGenerate||!1}}catch(b){}})},checkRunningTask(){return A(this,null,function*(){try{const b=yield J.get("/api/ai/batch-task/status");b.data.success&&b.data.running&&(this.batchRunning=!0,this.batchType=b.data.type,this.batchMode=b.data.mode,this.batchProgress={current:b.data.current||0,total:b.data.total||0,currentCard:b.data.currentCard||""},this.startPolling())}catch(b){}})},onProviderChange(){this.config.apiKey="",this.config.hasApiKey=!1},saveConfig(){return A(this,null,function*(){var b,t;this.saving=!0;try{const l=yield J.post("/api/ai/config",{provider:this.config.provider,apiKey:this.config.apiKey||void 0,baseUrl:this.config.baseUrl||this.defaultBaseUrl,model:this.config.model||this.defaultModel,requestDelay:this.config.requestDelay,autoGenerate:this.config.autoGenerate});l.data.success?(this.showMessage("é…ç½®ä¿å­˜æˆåŠŸ","success"),this.config.hasApiKey=!0,this.config.apiKey=""):this.showMessage(l.data.message,"error")}catch(l){this.showMessage(((t=(b=l.response)==null?void 0:b.data)==null?void 0:t.message)||"ä¿å­˜å¤±è´¥","error")}finally{this.saving=!1}})},testConnection(){return A(this,null,function*(){var b,t;this.testing=!0;try{const l=yield J.post("/api/ai/test");l.data.success?this.showMessage(`è¿æ¥æˆåŠŸ: ${l.data.response}`,"success"):this.showMessage(l.data.message,"error")}catch(l){this.showMessage(((t=(b=l.response)==null?void 0:b.data)==null?void 0:t.message)||"è¿æ¥å¤±è´¥","error")}finally{this.testing=!1}})},refreshStats(){return A(this,null,function*(){if(!this.refreshing){this.refreshing=!0;try{const[b,t,l,T]=yield Promise.all([J.get("/api/ai/empty-cards?type=name"),J.get("/api/ai/empty-cards?type=description"),J.get("/api/ai/empty-cards?type=tags"),J.get("/api/ai/empty-cards?type=description&mode=all")]);this.stats={emptyName:b.data.total||0,emptyDesc:t.data.total||0,emptyTags:l.data.total||0,total:T.data.total||0}}catch(b){}finally{this.refreshing=!1}}})},startBatch(b,t){return A(this,null,function*(){var l,T;if(!(this.starting||this.batchRunning)){if(t==="all"){const a={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},x=`ç¡®å®šè¦é‡æ–°ç”Ÿæˆæ‰€æœ‰å¡ç‰‡çš„${a[b]}å—ï¼Ÿè¿™å°†è¦†ç›–ç°æœ‰${a[b]}ã€‚`;if(!confirm(x))return}this.starting=!0,this.stopPolling();try{const a=yield J.post("/api/ai/batch-task/start",{type:b,mode:t});if(!a.data.success){this.showMessage(a.data.message||"å¯åŠ¨ä»»åŠ¡å¤±è´¥","error");return}if(a.data.total===0){this.showMessage("æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡","info"),yield this.refreshStats();return}this.batchType=b,this.batchMode=t,this.batchProgress={current:0,total:a.data.total,currentCard:"æ­£åœ¨å¤„ç†..."},this.batchRunning=!0,this.showMessage(`ä»»åŠ¡å·²å¯åŠ¨ï¼Œå…± ${a.data.total} ä¸ªå¡ç‰‡`,"info"),this.startPolling()}catch(a){this.showMessage(((T=(l=a.response)==null?void 0:l.data)==null?void 0:T.message)||"å¯åŠ¨ä»»åŠ¡å¤±è´¥","error")}finally{this.starting=!1}}})},startPolling(){const b=()=>A(this,null,function*(){if(!this.batchRunning){this.stopPolling();return}try{const t=yield J.get("/api/ai/batch-task/status");if(!t.data.success){this.pollTimer=setTimeout(b,1500);return}t.data.total>0&&(this.batchProgress.current=t.data.current||0,this.batchProgress.total=t.data.total,this.batchProgress.currentCard=t.data.currentCard||""),t.data.running?this.pollTimer=setTimeout(b,800):this.onTaskComplete(t.data)}catch(t){this.pollTimer=setTimeout(b,2e3)}});b()},onTaskComplete(b){this.stopPolling(),this.batchRunning=!1;const t=b.successCount||0,l=b.total||this.batchProgress.total;l>0?this.showMessage(`å®Œæˆï¼æˆåŠŸå¤„ç† ${t} / ${l} ä¸ªå¡ç‰‡`,"success"):this.showMessage("ä»»åŠ¡å·²å®Œæˆ","success"),setTimeout(()=>this.refreshStats(),300)},stopBatch(){return A(this,null,function*(){if(!this.stopping){this.stopping=!0;try{yield J.post("/api/ai/batch-task/stop"),this.showMessage("æ­£åœ¨åœæ­¢ä»»åŠ¡...","info")}catch(b){}finally{setTimeout(()=>{this.stopping=!1},2e3)}}})},getExistingTags(){return A(this,null,function*(){try{return(yield J.get("/api/tags")).data.map(t=>t.name)}catch(b){return[]}})},showMessage(b,t="info"){this.message=b,this.messageType=t,setTimeout(()=>{this.message=""},5e3)}}},bi={class:"ai-settings"},fi={class:"config-section"},hi={class:"form-group"},yi={key:0,class:"form-group"},wi={class:"input-with-icon"},ki=["type","placeholder"],_i={key:1,class:"form-group"},$i=["placeholder"],Ci={class:"form-group"},Mi=["placeholder"],xi={class:"form-group"},Bi={class:"form-group"},Ui={class:"checkbox-label"},Vi={class:"btn-group"},Ai=["disabled"],Ti=["disabled"],Di={class:"batch-section"},Ii={key:0,class:"stats-row"},Si={class:"stat-item"},Li={class:"stat-value"},Pi={class:"stat-item"},Wi={class:"stat-value"},Ni={class:"stat-item"},Ki={class:"stat-value"},zi={class:"stat-item"},Ei={class:"stat-value"},Ri=["disabled"],Oi={key:1,class:"batch-idle"},Hi={class:"batch-group"},Fi={class:"btn-group"},qi=["disabled"],Gi=["disabled"],ji=["disabled"],Ji={class:"batch-group"},Qi={class:"btn-group"},Xi=["disabled"],Yi=["disabled"],Zi=["disabled"],er={key:2,class:"batch-progress"},tr={class:"progress-header"},sr={class:"progress-bar"},ar={key:0,class:"progress-info"},lr={class:"current-card"},or=["disabled"];function nr(b,t,l,T,a,x){var I,D,v,h,y,g;return u(),c("div",bi,[t[38]||(t[38]=e("h2",null,"ğŸ¤– AI æ™ºèƒ½ç”Ÿæˆ",-1)),e("div",fi,[t[28]||(t[28]=e("h3",null,"API é…ç½®",-1)),e("div",hi,[t[19]||(t[19]=e("label",null,"API æä¾›å•†",-1)),U(e("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>a.config.provider=d),onChange:t[1]||(t[1]=(...d)=>x.onProviderChange&&x.onProviderChange(...d))},[...t[18]||(t[18]=[de('<optgroup label="å›½å¤–æœåŠ¡" data-v-315bbe12><option value="openai" data-v-315bbe12>OpenAI</option><option value="anthropic" data-v-315bbe12>Anthropic Claude</option><option value="gemini" data-v-315bbe12>Google Gemini</option><option value="groq" data-v-315bbe12>Groq</option></optgroup><optgroup label="å›½å†…æœåŠ¡" data-v-315bbe12><option value="deepseek" data-v-315bbe12>DeepSeek (æ¨è)</option><option value="zhipu" data-v-315bbe12>æ™ºè°± GLM</option><option value="qwen" data-v-315bbe12>é€šä¹‰åƒé—®</option><option value="doubao" data-v-315bbe12>è±†åŒ…</option><option value="moonshot" data-v-315bbe12>Moonshot (Kimi)</option></optgroup><optgroup label="æœ¬åœ°/è‡ªå®šä¹‰" data-v-315bbe12><option value="ollama" data-v-315bbe12>Ollama (æœ¬åœ°)</option><option value="custom" data-v-315bbe12>è‡ªå®šä¹‰ OpenAI å…¼å®¹</option></optgroup>',3)])],544),[[ye,a.config.provider]])]),x.needsApiKey?(u(),c("div",yi,[t[20]||(t[20]=e("label",null,"API Key",-1)),e("div",wi,[U(e("input",{type:a.showApiKey?"text":"password","onUpdate:modelValue":t[2]||(t[2]=d=>a.config.apiKey=d),placeholder:a.config.hasApiKey?"å·²é…ç½®ï¼ˆç•™ç©ºä¿æŒä¸å˜ï¼‰":"è¯·è¾“å…¥ API Key"},null,8,ki),[[Ie,a.config.apiKey]]),e("button",{type:"button",class:"icon-btn",onClick:t[3]||(t[3]=d=>a.showApiKey=!a.showApiKey)},p(a.showApiKey?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"),1)])])):N("",!0),x.needsBaseUrl?(u(),c("div",_i,[t[21]||(t[21]=e("label",null,"Base URL",-1)),U(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=d=>a.config.baseUrl=d),placeholder:x.defaultBaseUrl},null,8,$i),[[L,a.config.baseUrl]]),t[22]||(t[22]=e("span",{class:"hint"},"ä¸éœ€è¦åŠ  /v1/chat/completions",-1))])):N("",!0),e("div",Ci,[t[23]||(t[23]=e("label",null,"æ¨¡å‹åç§°",-1)),U(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=d=>a.config.model=d),placeholder:x.defaultModel},null,8,Mi),[[L,a.config.model]])]),e("div",xi,[t[24]||(t[24]=e("label",null,"è¯·æ±‚é—´éš” (ms)",-1)),U(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=d=>a.config.requestDelay=d),min:"500",max:"10000"},null,512),[[L,a.config.requestDelay,void 0,{number:!0}]]),t[25]||(t[25]=e("span",{class:"hint"},"æ‰¹é‡ç”Ÿæˆæ—¶çš„è°ƒç”¨é—´éš”ï¼Œé˜²æ­¢è§¦å‘é™æµ",-1))]),e("div",Bi,[e("label",Ui,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=d=>a.config.autoGenerate=d)},null,512),[[le,a.config.autoGenerate]]),t[26]||(t[26]=e("span",null,"æ·»åŠ å¡ç‰‡æ—¶è‡ªåŠ¨ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾",-1))]),t[27]||(t[27]=e("span",{class:"hint"},"å¼€å¯åï¼Œæ–°æ·»åŠ çš„å¡ç‰‡ä¼šè‡ªåŠ¨ä½¿ç”¨ AI ç”Ÿæˆç®€æ´çš„åç§°ã€æè¿°å’Œæ¨èæ ‡ç­¾",-1))]),e("div",Vi,[e("button",{class:"btn btn-secondary",onClick:t[8]||(t[8]=(...d)=>x.testConnection&&x.testConnection(...d)),disabled:a.testing},p(a.testing?"æµ‹è¯•ä¸­...":"ğŸ”— æµ‹è¯•è¿æ¥"),9,Ai),e("button",{class:"btn btn-primary",onClick:t[9]||(t[9]=(...d)=>x.saveConfig&&x.saveConfig(...d)),disabled:a.saving},p(a.saving?"ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜é…ç½®"),9,Ti)])]),e("div",Di,[t[37]||(t[37]=e("h3",null,"æ‰¹é‡ç”Ÿæˆ",-1)),a.stats?(u(),c("div",Ii,[e("div",Si,[e("span",Li,p(a.stats.total),1),t[29]||(t[29]=e("span",{class:"stat-label"},"æ€»å¡ç‰‡æ•°",-1))]),e("div",Pi,[e("span",Wi,p(a.stats.emptyName),1),t[30]||(t[30]=e("span",{class:"stat-label"},"ç¼ºå°‘åç§°",-1))]),e("div",Ni,[e("span",Ki,p(a.stats.emptyDesc),1),t[31]||(t[31]=e("span",{class:"stat-label"},"ç¼ºå°‘æè¿°",-1))]),e("div",zi,[e("span",Ei,p(a.stats.emptyTags),1),t[32]||(t[32]=e("span",{class:"stat-label"},"ç¼ºå°‘æ ‡ç­¾",-1))]),e("button",{class:"btn btn-text",onClick:t[10]||(t[10]=(...d)=>x.refreshStats&&x.refreshStats(...d)),disabled:a.refreshing},p(a.refreshing?"åˆ·æ–°ä¸­...":"ğŸ”„ åˆ·æ–°"),9,Ri)])):N("",!0),a.batchRunning?(u(),c("div",er,[e("div",tr,[e("span",null,p(x.batchLabel)+"ä¸­...",1),e("span",null,p(a.batchProgress.current)+" / "+p(a.batchProgress.total),1)]),e("div",sr,[e("div",{class:"progress-fill",style:we({width:x.progressPercent+"%"})},null,4)]),a.batchProgress.currentCard?(u(),c("div",ar,[e("span",lr,p(a.batchProgress.currentCard),1)])):N("",!0),e("button",{class:"btn btn-danger",onClick:t[17]||(t[17]=(...d)=>x.stopBatch&&x.stopBatch(...d)),disabled:a.stopping},p(a.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢"),9,or)])):(u(),c("div",Oi,[e("div",Hi,[t[33]||(t[33]=e("h4",null,"è¡¥å……ç¼ºå¤±å†…å®¹",-1)),t[34]||(t[34]=e("p",{class:"hint"},"åªä¸ºç¼ºå°‘å†…å®¹çš„å¡ç‰‡ç”Ÿæˆ",-1)),e("div",Fi,[e("button",{class:"btn btn-secondary",onClick:t[11]||(t[11]=d=>x.startBatch("name","empty")),disabled:!a.stats||a.stats.emptyName===0||a.starting}," ğŸ“ ç”Ÿæˆç¼ºå°‘çš„åç§° ("+p(((I=a.stats)==null?void 0:I.emptyName)||0)+") ",9,qi),e("button",{class:"btn btn-secondary",onClick:t[12]||(t[12]=d=>x.startBatch("description","empty")),disabled:!a.stats||a.stats.emptyDesc===0||a.starting}," âœ¨ ç”Ÿæˆç¼ºå°‘çš„æè¿° ("+p(((D=a.stats)==null?void 0:D.emptyDesc)||0)+") ",9,Gi),e("button",{class:"btn btn-secondary",onClick:t[13]||(t[13]=d=>x.startBatch("tags","empty")),disabled:!a.stats||a.stats.emptyTags===0||a.starting}," ğŸ·ï¸ ç”Ÿæˆç¼ºå°‘çš„æ ‡ç­¾ ("+p(((v=a.stats)==null?void 0:v.emptyTags)||0)+") ",9,ji)])]),e("div",Ji,[t[35]||(t[35]=e("h4",null,"é‡æ–°ç”Ÿæˆæ‰€æœ‰",-1)),t[36]||(t[36]=e("p",{class:"hint"},"è¦†ç›–æ‰€æœ‰å¡ç‰‡çš„ç°æœ‰å†…å®¹",-1)),e("div",Qi,[e("button",{class:"btn btn-warning",onClick:t[14]||(t[14]=d=>x.startBatch("name","all")),disabled:!a.stats||a.stats.total===0||a.starting}," ğŸ”„ é‡æ–°ç”Ÿæˆæ‰€æœ‰åç§° ("+p(((h=a.stats)==null?void 0:h.total)||0)+") ",9,Xi),e("button",{class:"btn btn-warning",onClick:t[15]||(t[15]=d=>x.startBatch("description","all")),disabled:!a.stats||a.stats.total===0||a.starting}," ğŸ”„ é‡æ–°ç”Ÿæˆæ‰€æœ‰æè¿° ("+p(((y=a.stats)==null?void 0:y.total)||0)+") ",9,Yi),e("button",{class:"btn btn-warning",onClick:t[16]||(t[16]=d=>x.startBatch("tags","all")),disabled:!a.stats||a.stats.total===0||a.starting}," ğŸ”„ é‡æ–°ç”Ÿæˆæ‰€æœ‰æ ‡ç­¾ ("+p(((g=a.stats)==null?void 0:g.total)||0)+") ",9,Zi)])])]))]),a.message?(u(),c("div",{key:0,class:E(["message",a.messageType])},p(a.message),3)):N("",!0)])}const ir=X(gi,[["render",nr],["__scopeId","data-v-315bbe12"]]),rr={key:0,class:"login-container"},dr={class:"login-card"},ur={class:"login-form"},cr={class:"password-input-wrapper"},vr=["type"],pr={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},mr={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},gr={class:"login-buttons"},br=["disabled"],fr={key:0,class:"login-error"},hr={key:1,class:"admin-layout"},yr={class:"menu-list"},wr={class:"admin-main"},kr={class:"admin-header"},_r={class:"header-title"},$r={class:"admin-content"},De=1800*1e3,Cr={__name:"Admin",setup(b){const t=k("welcome");let l=null,T=Date.now();function a(){T=Date.now(),localStorage.setItem("lastActivityTime",T.toString()),l&&clearTimeout(l),n.value&&(l=setTimeout(()=>{x()},De))}function x(){n.value&&(alert("ç”±äºé•¿æ—¶é—´æœªæ“ä½œï¼Œå·²è‡ªåŠ¨é€€å‡ºç™»å½•"),O())}function I(){const S=localStorage.getItem("lastActivityTime");return S&&Date.now()-parseInt(S)>=De?(localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),!0):!1}const D=["mousedown","mousemove","keydown","scroll","touchstart","click"];function v(){D.forEach(S=>{document.addEventListener(S,a,{passive:!0})})}function h(){D.forEach(S=>{document.removeEventListener(S,a)})}Oe(()=>{l&&clearTimeout(l),h()});const y={welcome:xt,menu:ys,card:oa,duplicate:Ra,tag:nl,promo:Wl,friend:Gl,user:vo,backup:mi,ai:ir},g=re(()=>y[t.value]),d=re(()=>t.value==="welcome"?{lastLoginTime:f.value,lastLoginIp:i.value,currentUsername:r.value}:{}),f=k(""),i=k(""),r=k("admin"),n=k(!1),B=k(""),C=k(""),M=k(!1),R=k(""),Y=k(!1),Z=k(!1),ee=re(()=>{switch(t.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"promo":return"å®£ä¼ ç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";case"ai":return"AI è®¾ç½®";default:return""}});oe(()=>A(null,null,function*(){if(I()){n.value=!1;return}localStorage.getItem("token")?(n.value=!0,yield se(),n.value&&(a(),v())):n.value=!1}));function se(){return A(this,null,function*(){try{const S=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(S.ok){const m=yield S.json();f.value=m.last_login_time||"",i.value=m.last_login_ip||"",r.value=m.username||"admin"}else S.status===401&&(console.warn("TokenéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨é€€å‡ºç™»å½•"),O())}catch(S){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",S)}})}function H(){return A(this,null,function*(){var S,m;if(!B.value||!C.value){R.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}M.value=!0,R.value="";try{const o=yield ft(B.value,C.value);o.data.token&&(localStorage.setItem("token",o.data.token),n.value=!0,f.value=o.data.lastLoginTime||"",i.value=o.data.lastLoginIp||"",yield se(),a(),v())}catch(o){R.value=((m=(S=o.response)==null?void 0:S.data)==null?void 0:m.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{M.value=!1}})}function O(){l&&(clearTimeout(l),l=null),h(),localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),n.value=!1,B.value="",C.value="",R.value=""}function W(){window.open("/","_blank")}function w(){Z.value=!Z.value}function V(){Z.value=!1}return(S,m)=>n.value?(u(),c("div",hr,[e("aside",{class:E(["admin-sider",{open:Z.value}]),onClick:Me(V,["self"])},[e("div",{class:"logo clickable",onClick:m[3]||(m[3]=o=>{t.value="welcome",V()})},"Admin"),e("ul",yr,[e("li",{class:E({active:t.value==="menu"}),onClick:m[4]||(m[4]=o=>{t.value="menu",V()})},"æ ç›®ç®¡ç†",2),e("li",{class:E({active:t.value==="card"}),onClick:m[5]||(m[5]=o=>{t.value="card",V()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:E({active:t.value==="duplicate"}),onClick:m[6]||(m[6]=o=>{t.value="duplicate",V()})},"å»é‡ç®¡ç†",2),e("li",{class:E({active:t.value==="tag"}),onClick:m[7]||(m[7]=o=>{t.value="tag",V()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:E({active:t.value==="promo"}),onClick:m[8]||(m[8]=o=>{t.value="promo",V()})},"å®£ä¼ ç®¡ç†",2),e("li",{class:E({active:t.value==="friend"}),onClick:m[9]||(m[9]=o=>{t.value="friend",V()})},"å‹é“¾ç®¡ç†",2),e("li",{class:E({active:t.value==="user"}),onClick:m[10]||(m[10]=o=>{t.value="user",V()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:E({active:t.value==="backup"}),onClick:m[11]||(m[11]=o=>{t.value="backup",V()})},"å¤‡ä»½ç®¡ç†",2),e("li",{class:E({active:t.value==="ai"}),onClick:m[12]||(m[12]=o=>{t.value="ai",V()})},"AI è®¾ç½®",2)])],2),e("main",wr,[e("div",kr,[e("button",{class:"menu-toggle",onClick:w}," â˜° "),e("div",_r,p(ee.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:W,title:"è¿›å…¥ä¸»é¡µ"},[...m[17]||(m[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:O},"é€€å‡ºç™»å½•")])]),e("div",$r,[He(qe,{name:"fade",mode:"out-in"},{default:Fe(()=>[(u(),Ge(je(g.value),Je({key:t.value},d.value),null,16))]),_:1})]),m[18]||(m[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[z("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(u(),c("div",rr,[e("div",dr,[m[16]||(m[16]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",ur,[U(e("input",{"onUpdate:modelValue":m[0]||(m[0]=o=>B.value=o),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:Ce(H,["enter"])},null,544),[[L,B.value]]),e("div",cr,[U(e("input",{"onUpdate:modelValue":m[1]||(m[1]=o=>C.value=o),type:Y.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:Ce(H,["enter"])},null,40,vr),[[Ie,C.value]]),e("span",{class:"toggle-password",onClick:m[2]||(m[2]=o=>Y.value=!Y.value)},[Y.value?(u(),c("svg",pr,[...m[13]||(m[13]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(u(),c("svg",mr,[...m[14]||(m[14]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",gr,[e("button",{onClick:W,class:"back-btn"},[...m[15]||(m[15]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),z(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:H,class:"login-btn",disabled:M.value},p(M.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,br)]),R.value?(u(),c("p",fr,p(R.value),1)):N("",!0)])])]))}},Ur=X(Cr,[["__scopeId","data-v-52d75759"]]);export{Ur as default};
