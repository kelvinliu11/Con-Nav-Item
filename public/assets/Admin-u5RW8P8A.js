var Ee=Object.defineProperty,Oe=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var He=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var Ue=(m,s,l)=>s in m?Ee(m,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[s]=l,he=(m,s)=>{for(var l in s||(s={}))He.call(s,l)&&Ue(m,l,s[l]);if(xe)for(var l of xe(s))Fe.call(s,l)&&Ue(m,l,s[l]);return m},ke=(m,s)=>Oe(m,qe(s));var B=(m,s,l)=>new Promise((V,a)=>{var h=p=>{try{D(l.next(p))}catch(n){a(n)}},P=p=>{try{D(l.throw(p))}catch(n){a(n)}},D=p=>p.done?V(p.value):Promise.resolve(p.value).then(h,P);D((l=l.apply(m,s)).next())});import{_ as Y,c as i,b as o,f as e,t as u,A as re,r as _,o as le,d as K,k as U,v as L,m as Ce,F as H,e as F,i as ie,w as Ae,B as ye,s as z,y as we,h as Me,g as W,C as ne,z as be,q as ae,j as Ie,D as Pe,l as Se,T as Le,a as Ge,E as je,G as Je,H as Qe}from"./index-uTJ9EyHS.js";import{g as Ke,m as Xe,w as Ye,t as Ze,u as es,n as ss,o as ts,c as Ne,k as as,p as Be,x as Ve,f as ls,z as ns,A as os,B as _e,C as is,D as rs,E as ds,F as us,i as oe,b as cs,G as vs,H as ps,I as ms,J as gs,K as hs,L as fs,M as bs}from"./urlNormalizer-B9d79qZ3.js";const ys={class:"welcome-page"},ws={class:"welcome-title"},ks={class:"welcome-cards"},_s={class:"welcome-card"},$s={class:"welcome-value"},Cs={class:"welcome-card"},Ms={class:"welcome-value"},xs={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(m){return(s,l)=>(o(),i("div",ys,[e("h2",ws,"æ¬¢è¿æ‚¨ï¼Œ"+u(m.currentUsername||"admin")+"ï¼",1),e("div",ks,[e("div",_s,[l[0]||(l[0]=re('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",$s,u(m.lastLoginTime||"--"),1)]),e("div",Cs,[l[1]||(l[1]=re('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",Ms,u(m.lastLoginIp||"--"),1)])])]))}},Us=Y(xs,[["__scopeId","data-v-5cc4f846"]]),As={class:"menu-manage"},Bs={key:0,class:"loading-overlay"},Vs={class:"menu-header"},Ts={class:"menu-add"},Ds=["disabled"],Is={class:"menu-content"},Ps={key:0,class:"empty-state"},Ss={class:"menu-card-header"},Ls={class:"menu-title"},Ks={class:"menu-name"},Ns={class:"menu-order"},Ws={class:"menu-actions"},Rs=["onClick"],zs=["onClick"],Es=["onClick"],Os={key:0,class:"sub-menu-list"},qs={class:"sub-menu-name"},Hs={class:"sub-menu-order"},Fs={class:"sub-menu-actions"},Gs=["onClick"],js=["onClick"],Js={key:1,class:"no-sub-menu"},Qs={key:1,class:"modal-overlay"},Xs={class:"modal"},Ys={class:"modal-header"},Zs={class:"modal-body"},et={class:"form-group"},st={class:"form-group"},tt={class:"modal-footer"},at=["disabled"],lt={key:2,class:"modal-overlay"},nt={class:"modal"},ot={class:"modal-header"},it={class:"modal-body"},rt={class:"form-group"},dt={class:"form-group"},ut={class:"modal-footer"},ct=["disabled"],vt={key:3,class:"modal-overlay"},pt={class:"modal"},mt={class:"modal-body"},gt={class:"form-group"},ht={class:"form-group"},ft={class:"modal-footer"},bt=["disabled"],yt={__name:"MenuManage",setup(m){const s=_([]),l=_(!1),V=_("åŠ è½½ä¸­..."),a=_(""),h=_(!1),P=_(null),D=_({name:"",order:0}),p=_(!1),n=_(null),y=_(""),f=_({name:"",order:0}),M=_(!1),b=_(null),c=_({name:"",order:0});le(()=>{r()});function v(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[æ ç›®ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(N){console.warn("[æ ç›®ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",N)}}function r(N=!1){return B(this,null,function*(){var k,T;l.value=!0,V.value="åŠ è½½ä¸­...";try{const I=yield Ke(!0);s.value=I.data||[],N&&v()}catch(I){alert("åŠ è½½å¤±è´¥: "+(((T=(k=I.response)==null?void 0:k.data)==null?void 0:T.error)||I.message))}finally{l.value=!1}})}function A(){return B(this,null,function*(){var N,k;if(a.value.trim()){l.value=!0,V.value="æ·»åŠ ä¸­...";try{const T=s.value.length?Math.max(...s.value.map(I=>I.order||0)):0;yield Xe({name:a.value.trim(),order:T+1}),a.value="",yield r(!0)}catch(T){alert("æ·»åŠ å¤±è´¥: "+(((k=(N=T.response)==null?void 0:N.data)==null?void 0:k.error)||T.message)),l.value=!1}}})}function C(N){P.value=N,D.value={name:N.name,order:N.order},h.value=!0}function x(){return B(this,null,function*(){var I,g;if(!D.value.name.trim()||!P.value)return;const N=P.value.id,k=D.value.name.trim(),T=D.value.order;R(),l.value=!0,V.value="ä¿å­˜ä¸­...";try{yield es(N,{name:k,order:T}),yield r(!0)}catch(d){alert("ä¿å­˜å¤±è´¥: "+(((g=(I=d.response)==null?void 0:I.data)==null?void 0:g.error)||d.message)),l.value=!1}})}function O(N){return B(this,null,function*(){var k,T;if(confirm(`ç¡®å®šåˆ é™¤ä¸»èœå•ã€Œ${N.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ï¼`)){l.value=!0,V.value="åˆ é™¤ä¸­...";try{yield Ye(N.id),yield r(!0)}catch(I){alert("åˆ é™¤å¤±è´¥: "+(((T=(k=I.response)==null?void 0:k.data)==null?void 0:T.error)||I.message)),l.value=!1}}})}function J(N){n.value=N.id,y.value=N.name;const k=N.subMenus||[],T=k.length?Math.max(...k.map(I=>I.order||0)):0;f.value={name:"",order:T+1},p.value=!0}function Z(){return B(this,null,function*(){var I,g;if(!f.value.name.trim()||!n.value)return;const N=n.value,k=f.value.name.trim(),T=f.value.order;R(),l.value=!0,V.value="æ·»åŠ ä¸­...";try{yield ss(N,{name:k,order:T}),yield r(!0)}catch(d){alert("æ·»åŠ å¤±è´¥: "+(((g=(I=d.response)==null?void 0:I.data)==null?void 0:g.error)||d.message)),l.value=!1}})}function ee(N,k){b.value=k,c.value={name:k.name,order:k.order},M.value=!0}function te(){return B(this,null,function*(){var I,g;if(!c.value.name.trim()||!b.value)return;const N=b.value.id,k=c.value.name.trim(),T=c.value.order;R(),l.value=!0,V.value="ä¿å­˜ä¸­...";try{yield ts(N,{name:k,order:T}),yield r(!0)}catch(d){alert("ä¿å­˜å¤±è´¥: "+(((g=(I=d.response)==null?void 0:I.data)==null?void 0:g.error)||d.message)),l.value=!1}})}function se(N){return B(this,null,function*(){var k,T;if(confirm(`ç¡®å®šåˆ é™¤å­èœå•ã€Œ${N.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å¡ç‰‡ï¼`)){l.value=!0,V.value="åˆ é™¤ä¸­...";try{yield Ze(N.id),yield r(!0)}catch(I){alert("åˆ é™¤å¤±è´¥: "+(((T=(k=I.response)==null?void 0:k.data)==null?void 0:T.error)||I.message)),l.value=!1}}})}function R(){h.value=!1,p.value=!1,M.value=!1,P.value=null,b.value=null}return(N,k)=>(o(),i("div",As,[l.value?(o(),i("div",Bs,[k[7]||(k[7]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,u(V.value),1)])):K("",!0),e("div",Vs,[k[8]||(k[8]=e("h2",{class:"page-title"},"æ ç›®ç®¡ç†",-1)),e("div",Ts,[U(e("input",{"onUpdate:modelValue":k[0]||(k[0]=T=>a.value=T),placeholder:"è¾“å…¥ä¸»èœå•åç§°",class:"input",onKeyup:Ce(A,["enter"])},null,544),[[L,a.value]]),e("button",{class:"btn btn-primary",onClick:A,disabled:l.value||!a.value.trim()}," + æ·»åŠ ä¸»èœå• ",8,Ds)])]),e("div",Is,[s.value.length===0?(o(),i("div",Ps,[...k[9]||(k[9]=[e("p",null,"æš‚æ— èœå•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªä¸»èœå•",-1)])])):K("",!0),(o(!0),i(H,null,F(s.value,T=>(o(),i("div",{key:T.id,class:"menu-card"},[e("div",Ss,[e("div",Ls,[e("span",Ks,u(T.name),1),e("span",Ns,"æ’åº: "+u(T.order),1)]),e("div",Ws,[e("button",{class:"btn-icon btn-edit",onClick:I=>C(T),title:"ç¼–è¾‘"},[...k[10]||(k[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Rs),e("button",{class:"btn-icon btn-add",onClick:I=>J(T),title:"æ·»åŠ å­èœå•"},[...k[11]||(k[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1)])],8,zs),e("button",{class:"btn-icon btn-delete",onClick:I=>O(T),title:"åˆ é™¤"},[...k[12]||(k[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Es)])]),T.subMenus&&T.subMenus.length>0?(o(),i("div",Os,[(o(!0),i(H,null,F(T.subMenus,I=>(o(),i("div",{key:I.id,class:"sub-menu-item"},[e("span",qs,u(I.name),1),e("span",Hs,"æ’åº: "+u(I.order),1),e("div",Fs,[e("button",{class:"btn-icon-sm btn-edit",onClick:g=>ee(T,I),title:"ç¼–è¾‘"},[...k[13]||(k[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Gs),e("button",{class:"btn-icon-sm btn-delete",onClick:g=>se(I),title:"åˆ é™¤"},[...k[14]||(k[14]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,js)])]))),128))])):(o(),i("div",Js,[...k[15]||(k[15]=[e("span",null,"æš‚æ— å­èœå•",-1)])]))]))),128))]),h.value?(o(),i("div",Qs,[e("div",Xs,[e("div",Ys,[e("h3",null,u(P.value?"ç¼–è¾‘ä¸»èœå•":"æ·»åŠ å­èœå•"),1),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",Zs,[e("div",et,[k[16]||(k[16]=e("label",null,"åç§°",-1)),U(e("input",{"onUpdate:modelValue":k[1]||(k[1]=T=>D.value.name=T),type:"text",class:"input",placeholder:"è¯·è¾“å…¥åç§°"},null,512),[[L,D.value.name]])]),e("div",st,[k[17]||(k[17]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":k[2]||(k[2]=T=>D.value.order=T),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,D.value.order,void 0,{number:!0}]])])]),e("div",tt,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:x,disabled:!D.value.name.trim()},"ä¿å­˜",8,at)])])])):K("",!0),p.value?(o(),i("div",lt,[e("div",nt,[e("div",ot,[e("h3",null,"æ·»åŠ å­èœå•åˆ°ã€Œ"+u(y.value)+"ã€",1),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",it,[e("div",rt,[k[18]||(k[18]=e("label",null,"å­èœå•åç§°",-1)),U(e("input",{"onUpdate:modelValue":k[3]||(k[3]=T=>f.value.name=T),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,f.value.name]])]),e("div",dt,[k[19]||(k[19]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":k[4]||(k[4]=T=>f.value.order=T),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,f.value.order,void 0,{number:!0}]])])]),e("div",ut,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:Z,disabled:!f.value.name.trim()},"æ·»åŠ ",8,ct)])])])):K("",!0),M.value?(o(),i("div",vt,[e("div",pt,[e("div",{class:"modal-header"},[k[20]||(k[20]=e("h3",null,"ç¼–è¾‘å­èœå•",-1)),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",mt,[e("div",gt,[k[21]||(k[21]=e("label",null,"å­èœå•åç§°",-1)),U(e("input",{"onUpdate:modelValue":k[5]||(k[5]=T=>c.value.name=T),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,c.value.name]])]),e("div",ht,[k[22]||(k[22]=e("label",null,"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":k[6]||(k[6]=T=>c.value.order=T),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,c.value.order,void 0,{number:!0}]])])]),e("div",ft,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:te,disabled:!c.value.name.trim()},"ä¿å­˜",8,bt)])])])):K("",!0)]))}},wt=Y(yt,[["__scopeId","data-v-7671c3a1"]]),kt={class:"card-manage"},_t={class:"card-header"},$t={class:"card-add"},Ct=["value"],Mt=["value"],xt={class:"card-card"},Ut={class:"card-table"},At=["onUpdate:modelValue","onBlur"],Bt=["onUpdate:modelValue","onBlur"],Vt=["onUpdate:modelValue","onBlur"],Tt=["onUpdate:modelValue","onBlur"],Dt=["onClick"],It={key:0,class:"selected-tags"},Pt={key:1,class:"tag-placeholder"},St=["onUpdate:modelValue","onBlur"],Lt=["onClick"],Kt={class:"modal-body"},Nt={key:0,class:"empty-tags"},Wt={key:1,class:"tag-options"},Rt=["checked","onChange"],zt={class:"modal-body"},Et={class:"duplicate-comparison"},Ot={class:"card-info-box existing"},qt={class:"card-details"},Ht={class:"detail-row"},Ft={class:"detail-value"},Gt={class:"detail-row"},jt={class:"detail-value url"},Jt={key:0,class:"detail-row"},Qt={class:"detail-value url"},Xt={class:"card-info-box pending"},Yt={class:"card-details"},Zt={class:"detail-row"},ea={class:"detail-value"},sa={class:"detail-row"},ta={class:"detail-value url"},aa={key:0,class:"detail-row"},la={class:"detail-value url"},na={__name:"CardManage",setup(m){const s=_([]),l=_([]),V=_(),a=_(""),h=_(""),P=_(""),D=_(""),p=_([]),n=_(!1),y=_(null),f=_([]),M=_(!1),b=_(null),c=_(null),v=ie(()=>{if(!V.value)return[];const g=s.value.find(d=>d.id===V.value);return(g==null?void 0:g.subMenus)||[]});le(()=>B(null,null,function*(){const g=yield Ke();s.value=g.data,s.value.length&&(V.value=s.value[0].id,a.value="");const d=yield Ne();p.value=d.data})),Ae(V,()=>{a.value="",C()}),Ae(a,C);function r(){a.value=""}function A(){C()}function C(){return B(this,null,function*(){if(!V.value)return;const g=yield ls(V.value,a.value||null);l.value=g.data})}function x(){return B(this,null,function*(){if(!h.value||!P.value)return;const g=l.value.find(d=>as({title:h.value,url:P.value},d));g?(b.value=g,c.value={menu_id:V.value,sub_menu_id:a.value||null,title:h.value,url:P.value,logo_url:D.value},M.value=!0):yield R({menu_id:V.value,sub_menu_id:a.value||null,title:h.value,url:P.value,logo_url:D.value})})}function O(g){return B(this,null,function*(){yield Be(g.id,{menu_id:V.value,sub_menu_id:a.value||null,title:g.title,url:g.url,logo_url:g.logo_url,desc:g.desc,order:g.order,tagIds:g.tags?g.tags.map(d=>d.id):[]}),C()})}function J(g){return B(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const d=l.value.findIndex(j=>j.id===g);d>-1&&l.value.splice(d,1);try{yield Ve(g)}catch(j){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",j),yield C()}})}function Z(g){y.value=g,f.value=g.tags?g.tags.map(d=>d.id):[],n.value=!0}function ee(){n.value=!1,y.value=null,f.value=[]}function te(g){const d=f.value.indexOf(g);d>-1?f.value.splice(d,1):f.value.push(g)}function se(){return B(this,null,function*(){y.value&&(yield Be(y.value.id,{menu_id:y.value.menu_id,sub_menu_id:y.value.sub_menu_id,title:y.value.title,url:y.value.url,logo_url:y.value.logo_url,desc:y.value.desc,order:y.value.order,tagIds:f.value}),ee(),C())})}function R(g){return B(this,null,function*(){yield ns(g),h.value="",P.value="",D.value="",C()})}function N(){M.value=!1,b.value=null,c.value=null}function k(){N(),h.value="",P.value="",D.value=""}function T(){return B(this,null,function*(){!c.value||!b.value||(yield Ve(b.value.id),yield R(c.value),N())})}function I(){c.value&&(h.value=c.value.title,P.value=c.value.url,D.value=c.value.logo_url||"",N(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(g,d)=>{var j,ue,ce,ve,pe,Q,me,ge;return o(),i("div",kt,[e("div",_t,[d[9]||(d[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",$t,[U(e("select",{"onUpdate:modelValue":d[0]||(d[0]=S=>V.value=S),class:"input narrow",onChange:r},[(o(!0),i(H,null,F(s.value,S=>(o(),i("option",{value:S.id,key:S.id},u(S.name),9,Ct))),128))],544),[[ye,V.value]]),U(e("select",{"onUpdate:modelValue":d[1]||(d[1]=S=>a.value=S),class:"input narrow",onChange:A},[d[7]||(d[7]=e("option",{value:""},"ä¸»èœå•",-1)),(o(!0),i(H,null,F(v.value,S=>(o(),i("option",{value:S.id,key:S.id},u(S.name),9,Mt))),128))],544),[[ye,a.value]]),U(e("input",{"onUpdate:modelValue":d[2]||(d[2]=S=>h.value=S),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[L,h.value]]),U(e("input",{"onUpdate:modelValue":d[3]||(d[3]=S=>P.value=S),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[L,P.value]]),U(e("input",{"onUpdate:modelValue":d[4]||(d[4]=S=>D.value=S),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[L,D.value]]),e("button",{class:"btn",onClick:x},[...d[8]||(d[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",xt,[e("table",Ut,[d[11]||(d[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),i(H,null,F(l.value,S=>(o(),i("tr",{key:S.id},[e("td",null,[U(e("input",{"onUpdate:modelValue":E=>S.title=E,onBlur:E=>O(S),class:"table-input"},null,40,At),[[L,S.title]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":E=>S.url=E,onBlur:E=>O(S),class:"table-input"},null,40,Bt),[[L,S.url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":E=>S.logo_url=E,onBlur:E=>O(S),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Vt),[[L,S.logo_url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":E=>S.desc=E,onBlur:E=>O(S),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,Tt),[[L,S.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:E=>Z(S)},[S.tags&&S.tags.length>0?(o(),i("div",It,[(o(!0),i(H,null,F(S.tags,E=>(o(),i("span",{key:E.id,class:"mini-tag",style:we({backgroundColor:E.color})},u(E.name),5))),128))])):(o(),i("span",Pt,"é€‰æ‹©æ ‡ç­¾"))],8,Dt)]),e("td",null,[U(e("input",{"onUpdate:modelValue":E=>S.order=E,type:"number",onBlur:E=>O(S),class:"table-input order-input"},null,40,St),[[L,S.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:E=>J(S.id),title:"åˆ é™¤"},[...d[10]||(d[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Lt)])]))),128))])])]),n.value?(o(),i("div",{key:0,class:"modal-overlay",onClick:ee},[e("div",{class:"modal-content",onClick:d[5]||(d[5]=Me(()=>{},["stop"]))},[e("div",{class:"modal-header"},[d[12]||(d[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:ee},"Ã—")]),e("div",Kt,[p.value.length===0?(o(),i("div",Nt,[...d[13]||(d[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(o(),i("div",Wt,[(o(!0),i(H,null,F(p.value,S=>(o(),i("label",{key:S.id,class:"tag-option"},[e("input",{type:"checkbox",checked:f.value.includes(S.id),onChange:E=>te(S.id)},null,40,Rt),e("span",{class:"tag-label",style:we({backgroundColor:S.color})},u(S.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:ee},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se},"ç¡®å®š")])])])):K("",!0),M.value?(o(),i("div",{key:1,class:"modal-overlay",onClick:N},[e("div",{class:"modal-content duplicate-modal",onClick:d[6]||(d[6]=Me(()=>{},["stop"]))},[e("div",{class:"modal-header"},[d[14]||(d[14]=re('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:N},"Ã—")]),e("div",zt,[d[24]||(d[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",Et,[e("div",Ot,[d[18]||(d[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",qt,[e("div",Ht,[d[15]||(d[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Ft,u((j=b.value)==null?void 0:j.title),1)]),e("div",Gt,[d[16]||(d[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",jt,u((ue=b.value)==null?void 0:ue.url),1)]),(ce=b.value)!=null&&ce.logo_url?(o(),i("div",Jt,[d[17]||(d[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Qt,u((ve=b.value)==null?void 0:ve.logo_url),1)])):K("",!0)])]),d[23]||(d[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",Xt,[d[22]||(d[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",Yt,[e("div",Zt,[d[19]||(d[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",ea,u((pe=c.value)==null?void 0:pe.title),1)]),e("div",sa,[d[20]||(d[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",ta,u((Q=c.value)==null?void 0:Q.url),1)]),(me=c.value)!=null&&me.logo_url?(o(),i("div",aa,[d[21]||(d[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",la,u((ge=c.value)==null?void 0:ge.logo_url),1)])):K("",!0)])])]),d[25]||(d[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:k},[...d[26]||(d[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),z(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:T},[...d[27]||(d[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),z(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:I},[...d[28]||(d[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),z(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):K("",!0)])}}},oa=Y(na,[["__scopeId","data-v-edd548d5"]]),ia={class:"duplicate-manage"},ra={class:"section-header"},da=["disabled"],ua={key:0,class:"duplicate-results"},ca={class:"result-summary"},va={class:"summary-card"},pa={class:"summary-value"},ma={class:"summary-card warning"},ga={class:"summary-value"},ha={class:"summary-card danger"},fa={class:"summary-value"},ba={class:"duplicate-groups"},ya={class:"group-header"},wa={class:"group-count"},ka={class:"card-item original"},_a={class:"card-info"},$a={class:"card-title"},Ca={class:"card-url"},Ma={key:0,class:"card-desc"},xa={class:"card-id"},Ua={class:"duplicates-list"},Aa={class:"card-info"},Ba={class:"card-title"},Va={class:"card-url"},Ta={key:0,class:"card-desc"},Da={class:"card-actions"},Ia={class:"card-id"},Pa=["onClick","disabled"],Sa={class:"group-actions"},La=["onClick","disabled"],Ka={class:"global-actions"},Na=["disabled"],Wa={key:1,class:"no-duplicates"},Ra={key:2,class:"initial-hint"},za={key:3,class:"error"},Ea={__name:"DuplicateManage",setup(m){const s=_(!1),l=_(!1),V=_(!1),a=_([]),h=_(0),P=_(0),D=_("");function p(){return B(this,null,function*(){var M,b;s.value=!0,D.value="";try{const c=yield os();h.value=c.data.total,a.value=c.data.duplicateGroups,P.value=c.data.duplicateCount,V.value=!0}catch(c){D.value=((b=(M=c.response)==null?void 0:M.data)==null?void 0:b.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",c)}finally{s.value=!1}})}function n(M){return B(this,null,function*(){var b,c,v;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){l.value=!0,D.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",M);const r=yield _e([M]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",r.data),r.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield p()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(r.data.message||"æœªçŸ¥é”™è¯¯")}catch(r){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",r),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=r.response)==null?void 0:b.data),D.value=((v=(c=r.response)==null?void 0:c.data)==null?void 0:v.error)||r.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}function y(M){return B(this,null,function*(){var c,v,r;const b=M.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${b} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${M.original.title}`)){l.value=!0,D.value="";try{const A=M.duplicates.map(x=>x.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",A);const C=yield _e(A);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",C.data),C.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield p()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(C.data.message||"æœªçŸ¥é”™è¯¯")}catch(A){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",A),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(c=A.response)==null?void 0:c.data),D.value=((r=(v=A.response)==null?void 0:v.data)==null?void 0:r.error)||A.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}function f(){return B(this,null,function*(){var b,c,v;const M=P.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${M} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){l.value=!0,D.value="";try{const r=a.value.flatMap(C=>C.duplicates.map(x=>x.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",r);const A=yield _e(r);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",A.data),A.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield p()):D.value="åˆ é™¤å¤±è´¥ï¼š"+(A.data.message||"æœªçŸ¥é”™è¯¯")}catch(r){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",r),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=r.response)==null?void 0:b.data),D.value=((v=(c=r.response)==null?void 0:c.data)==null?void 0:v.error)||r.message||"åˆ é™¤å¤±è´¥"}finally{l.value=!1}}})}return(M,b)=>(o(),i("div",ia,[e("div",ra,[b[0]||(b[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:p,class:"btn btn-primary",disabled:s.value},u(s.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,da)]),a.value.length>0?(o(),i("div",ua,[e("div",ca,[e("div",va,[b[1]||(b[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",pa,u(h.value),1)]),e("div",ma,[b[2]||(b[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",ga,u(a.value.length),1)]),e("div",ha,[b[3]||(b[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",fa,u(P.value),1)])]),e("div",ba,[(o(!0),i(H,null,F(a.value,(c,v)=>(o(),i("div",{key:v,class:"duplicate-group"},[e("div",ya,[e("h4",null,"é‡å¤ç»„ "+u(v+1),1),e("span",wa,u(c.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",ka,[b[4]||(b[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",_a,[e("div",$a,u(c.original.title),1),e("div",Ca,u(c.original.url),1),c.original.desc?(o(),i("div",Ma,u(c.original.desc),1)):K("",!0)]),e("div",xa,"ID: "+u(c.original.id),1)]),e("div",Ua,[(o(!0),i(H,null,F(c.duplicates,r=>(o(),i("div",{key:r.id,class:"card-item duplicate"},[b[5]||(b[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",Aa,[e("div",Ba,u(r.title),1),e("div",Va,u(r.url),1),r.desc?(o(),i("div",Ta,u(r.desc),1)):K("",!0)]),e("div",Da,[e("span",Ia,"ID: "+u(r.id),1),e("button",{onClick:A=>n(r.id),class:"btn-remove",disabled:l.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,Pa)])]))),128))]),e("div",Sa,[e("button",{onClick:r=>y(c),class:"btn btn-danger",disabled:l.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+u(c.duplicates.length)+" å¼ ) ",9,La)])]))),128))]),e("div",Ka,[e("button",{onClick:f,class:"btn btn-danger btn-large",disabled:l.value},u(l.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${P.value} å¼ )`),9,Na)])])):V.value&&a.value.length===0?(o(),i("div",Wa,[...b[6]||(b[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):V.value?K("",!0):(o(),i("div",Ra,[...b[7]||(b[7]=[re('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),D.value?(o(),i("p",za,u(D.value),1)):K("",!0)]))}},Oa=Y(Ea,[["__scopeId","data-v-62bbc778"]]),qa={class:"tag-manage"},Ha={class:"tag-header"},Fa={class:"tag-add"},Ga={class:"tag-content"},ja={key:0,class:"empty-state"},Ja={key:1,class:"tag-list"},Qa={class:"tag-info"},Xa=["onUpdate:modelValue","onBlur"],Ya={class:"tag-stats"},Za={class:"card-count"},el={class:"tag-controls"},sl=["onUpdate:modelValue","onChange"],tl={class:"tag-order"},al=["onUpdate:modelValue","onBlur"],ll={class:"tag-actions"},nl=["onClick"],ol={__name:"TagManage",setup(m){const s=_([]),l=_(""),V=_("#2566d8");le(a);function a(){return B(this,null,function*(){const p=yield Ne();s.value=p.data;for(const n of s.value)try{const y=yield is(n.id);n.cardCount=y.data.count}catch(y){n.cardCount=0}})}function h(){return B(this,null,function*(){var M,b;if(!l.value.trim())return;const p=s.value.length?Math.max(...s.value.map(c=>c.order||0)):0,n=l.value.trim(),y=V.value,f={id:Date.now(),name:n,color:y,order:p+1,cardCount:0,_temp:!0};s.value.push(f),l.value="",V.value="#2566d8";try{const c=yield rs({name:n,color:y,order:p+1}),v=s.value.findIndex(r=>r.id===f.id);v>-1&&(s.value[v]=ke(he({},c.data),{cardCount:0}))}catch(c){const v=s.value.findIndex(r=>r.id===f.id);v>-1&&s.value.splice(v,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(M=c.response)==null?void 0:M.data)==null?void 0:b.error)||c.message))}})}function P(p){return B(this,null,function*(){var n,y;if(!p._temp)try{yield ds(p.id,{name:p.name,color:p.color,order:p.order})}catch(f){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((y=(n=f.response)==null?void 0:n.data)==null?void 0:y.error)||f.message)),a()}})}function D(p){return B(this,null,function*(){var M,b;const n=s.value.find(c=>c.id===p);if(!n)return;const y=n.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${n.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${n.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${n.name}"å—ï¼Ÿ`;if(!confirm(y))return;const f=s.value.findIndex(c=>c.id===p);f>-1&&s.value.splice(f,1);try{yield us(p)}catch(c){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(M=c.response)==null?void 0:M.data)==null?void 0:b.error)||c.message)),a()}})}return(p,n)=>(o(),i("div",qa,[e("div",Ha,[n[3]||(n[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",Fa,[U(e("input",{"onUpdate:modelValue":n[0]||(n[0]=y=>l.value=y),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[L,l.value]]),U(e("input",{"onUpdate:modelValue":n[1]||(n[1]=y=>V.value=y),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[L,V.value]]),e("button",{class:"btn btn-primary",onClick:h},[...n[2]||(n[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",Ga,[s.value.length===0?(o(),i("div",ja,[...n[4]||(n[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(o(),i("div",Ja,[(o(!0),i(H,null,F(s.value,y=>(o(),i("div",{key:y.id,class:"tag-item"},[e("div",{class:"tag-preview",style:we({backgroundColor:y.color})},[...n[5]||(n[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",Qa,[U(e("input",{"onUpdate:modelValue":f=>y.name=f,onBlur:f=>P(y),class:"tag-name-input",maxlength:"20"},null,40,Xa),[[L,y.name]]),e("div",Ya,[e("span",Za,u(y.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",el,[U(e("input",{"onUpdate:modelValue":f=>y.color=f,type:"color",onChange:f=>P(y),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,sl),[[L,y.color]]),e("div",tl,[n[6]||(n[6]=e("span",{class:"order-label"},"æ’åº",-1)),U(e("input",{"onUpdate:modelValue":f=>y.order=f,type:"number",onBlur:f=>P(y),class:"order-input"},null,40,al),[[L,y.order,void 0,{number:!0}]])])]),e("div",ll,[e("button",{class:"btn btn-danger btn-icon",onClick:f=>D(y.id),title:"åˆ é™¤æ ‡ç­¾"},[...n[7]||(n[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,nl)])]))),128))]))])]))}},il=Y(ol,[["__scopeId","data-v-56efcb56"]]),rl={class:"promo-manage"},dl={key:0,class:"loading-overlay"},ul={class:"promo-header"},cl={class:"promo-form"},vl=["disabled"],pl={class:"promo-section"},ml={class:"promo-list"},gl={key:0,class:"empty-state"},hl={class:"promo-preview"},fl=["src"],bl={class:"promo-info"},yl={class:"promo-field"},wl=["onUpdate:modelValue","onBlur"],kl={class:"promo-field"},_l=["onUpdate:modelValue","onBlur"],$l={class:"promo-actions"},Cl=["onClick"],Ml={class:"promo-section"},xl={class:"promo-list"},Ul={key:0,class:"empty-state"},Al={class:"promo-preview"},Bl=["src"],Vl={class:"promo-info"},Tl={class:"promo-field"},Dl=["onUpdate:modelValue","onBlur"],Il={class:"promo-field"},Pl=["onUpdate:modelValue","onBlur"],Sl={class:"promo-actions"},Ll=["onClick"],fe="/api",Kl={__name:"PromoManage",setup(m){const s=()=>localStorage.getItem("token")||"",l=()=>({Authorization:`Bearer ${s()}`}),V=_([]),a=_(!1),h=_("åŠ è½½ä¸­..."),P=_({img:"",url:"",position:"left"}),D=ie(()=>V.value.filter(c=>c.position==="left")),p=ie(()=>V.value.filter(c=>c.position==="right"));le(()=>{n()});function n(){return B(this,null,function*(){var c,v;a.value=!0,h.value="åŠ è½½ä¸­...";try{const r=yield oe.get(`${fe}/promos`);let A=[];Array.isArray(r.data)?A=r.data:r.data&&Array.isArray(r.data.data)&&(A=r.data.data),V.value=A}catch(r){console.error("åŠ è½½å®£ä¼ å¤±è´¥:",r),alert("åŠ è½½å®£ä¼ å¤±è´¥: "+(((v=(c=r.response)==null?void 0:c.data)==null?void 0:v.error)||r.message))}finally{a.value=!1}})}function y(){return B(this,null,function*(){var c,v;if(!P.value.img||!P.value.url){alert("è¯·å¡«å†™å®£ä¼ å›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}a.value=!0,h.value="æ·»åŠ ä¸­...";try{yield oe.post(`${fe}/promos`,P.value,{headers:l()}),P.value={img:"",url:"",position:"left"},yield n()}catch(r){alert("æ·»åŠ å¤±è´¥: "+(((v=(c=r.response)==null?void 0:c.data)==null?void 0:v.error)||r.message)),a.value=!1}})}function f(c){return B(this,null,function*(){var v,r;try{yield oe.put(`${fe}/promos/${c.id}`,{img:c.img,url:c.url},{headers:l()})}catch(A){alert("æ›´æ–°å¤±è´¥: "+(((r=(v=A.response)==null?void 0:v.data)==null?void 0:r.error)||A.message)),yield n()}})}function M(c){return B(this,null,function*(){var v,r;if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªå®£ä¼ å—ï¼Ÿ")){a.value=!0,h.value="åˆ é™¤ä¸­...";try{yield oe.delete(`${fe}/promos/${c.id}`,{headers:l()}),yield n()}catch(A){alert("åˆ é™¤å¤±è´¥: "+(((r=(v=A.response)==null?void 0:v.data)==null?void 0:r.error)||A.message)),a.value=!1}}})}function b(c){c.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="60"><rect fill="%23f0f0f0" width="100" height="60"/><text x="50" y="35" text-anchor="middle" fill="%23999" font-size="12">å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'}return(c,v)=>(o(),i("div",rl,[a.value?(o(),i("div",dl,[v[3]||(v[3]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,u(h.value),1)])):K("",!0),e("div",ul,[v[5]||(v[5]=e("h2",{class:"page-title"},"å®£ä¼ ç®¡ç†",-1)),e("div",cl,[U(e("input",{"onUpdate:modelValue":v[0]||(v[0]=r=>P.value.img=r),placeholder:"å®£ä¼ å›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[L,P.value.img]]),U(e("input",{"onUpdate:modelValue":v[1]||(v[1]=r=>P.value.url=r),placeholder:"å®£ä¼ è·³è½¬é“¾æ¥",class:"input"},null,512),[[L,P.value.url]]),U(e("select",{"onUpdate:modelValue":v[2]||(v[2]=r=>P.value.position=r),class:"input select"},[...v[4]||(v[4]=[e("option",{value:"left"},"å·¦ä¾§å®£ä¼ ",-1),e("option",{value:"right"},"å³ä¾§å®£ä¼ ",-1)])],512),[[ye,P.value.position]]),e("button",{class:"btn btn-primary",onClick:y,disabled:!P.value.img||!P.value.url}," + æ·»åŠ å®£ä¼  ",8,vl)])]),e("div",pl,[v[8]||(v[8]=e("h3",{class:"section-title"},"ğŸ“ å·¦ä¾§å®£ä¼ ",-1)),e("div",ml,[D.value.length===0?(o(),i("div",gl,"æš‚æ— å·¦ä¾§å®£ä¼ ")):K("",!0),(o(!0),i(H,null,F(D.value,r=>(o(),i("div",{key:r.id,class:"promo-card"},[e("div",hl,[e("img",{src:r.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,fl)]),e("div",bl,[e("div",yl,[v[6]||(v[6]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":A=>r.img=A,class:"input",onBlur:A=>f(r)},null,40,wl),[[L,r.img]])]),e("div",kl,[v[7]||(v[7]=e("label",null,"è·³è½¬é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":A=>r.url=A,class:"input",onBlur:A=>f(r)},null,40,_l),[[L,r.url]])])]),e("div",$l,[e("button",{class:"btn btn-danger",onClick:A=>M(r)},"åˆ é™¤",8,Cl)])]))),128))])]),e("div",Ml,[v[11]||(v[11]=e("h3",{class:"section-title"},"ğŸ“ å³ä¾§å®£ä¼ ",-1)),e("div",xl,[p.value.length===0?(o(),i("div",Ul,"æš‚æ— å³ä¾§å®£ä¼ ")):K("",!0),(o(!0),i(H,null,F(p.value,r=>(o(),i("div",{key:r.id,class:"promo-card"},[e("div",Al,[e("img",{src:r.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,Bl)]),e("div",Vl,[e("div",Tl,[v[9]||(v[9]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":A=>r.img=A,class:"input",onBlur:A=>f(r)},null,40,Dl),[[L,r.img]])]),e("div",Il,[v[10]||(v[10]=e("label",null,"è·³è½¬é“¾æ¥",-1)),U(e("input",{"onUpdate:modelValue":A=>r.url=A,class:"input",onBlur:A=>f(r)},null,40,Pl),[[L,r.url]])])]),e("div",Sl,[e("button",{class:"btn btn-danger",onClick:A=>M(r)},"åˆ é™¤",8,Ll)])]))),128))])])]))}},Nl=Y(Kl,[["__scopeId","data-v-0221fbc3"]]),Wl={class:"friend-manage"},Rl={class:"friend-add"},zl={class:"friend-card"},El={class:"friend-table"},Ol=["onUpdate:modelValue","onBlur"],ql=["onUpdate:modelValue","onBlur"],Hl=["onUpdate:modelValue","onBlur"],Fl=["onClick"],Gl={__name:"FriendLinkManage",setup(m){const s=_([]),l=_(""),V=_(""),a=_("");le(h);function h(){return B(this,null,function*(){const n=yield cs();s.value=n.data})}function P(){return B(this,null,function*(){!l.value||!V.value||(yield vs({title:l.value,url:V.value,logo:a.value}),l.value="",V.value="",a.value="",h())})}function D(n){return B(this,null,function*(){yield ps(n.id,{title:n.title,url:n.url,logo:n.logo}),h()})}function p(n){return B(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const y=s.value.findIndex(f=>f.id===n);y>-1&&s.value.splice(y,1);try{yield ms(n)}catch(f){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",f),yield h()}})}return(n,y)=>(o(),i("div",Wl,[y[4]||(y[4]=e("div",{class:"friend-header"},null,-1)),e("div",Rl,[U(e("input",{"onUpdate:modelValue":y[0]||(y[0]=f=>l.value=f),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[L,l.value]]),U(e("input",{"onUpdate:modelValue":y[1]||(y[1]=f=>V.value=f),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[L,V.value]]),U(e("input",{"onUpdate:modelValue":y[2]||(y[2]=f=>a.value=f),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[L,a.value]]),e("button",{class:"btn",onClick:P},"æ·»åŠ å‹é“¾")]),e("div",zl,[e("table",El,[y[3]||(y[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),i(H,null,F(s.value,f=>(o(),i("tr",{key:f.id},[e("td",null,[U(e("input",{"onUpdate:modelValue":M=>f.title=M,onBlur:M=>D(f),class:"input"},null,40,Ol),[[L,f.title]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":M=>f.url=M,onBlur:M=>D(f),class:"input"},null,40,ql),[[L,f.url]])]),e("td",null,[U(e("input",{"onUpdate:modelValue":M=>f.logo=M,onBlur:M=>D(f),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Hl),[[L,f.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:M=>p(f.id)},"åˆ é™¤",8,Fl)])]))),128))])])])]))}},jl=Y(Gl,[["__scopeId","data-v-c25e838c"]]),Jl={class:"user-manage"},Ql={class:"user-card"},Xl={class:"username-section"},Yl={class:"username-form"},Zl={class:"current-username"},en={class:"username-display"},sn={class:"form-group"},tn={class:"form-actions"},an=["disabled"],ln={class:"password-section"},nn={class:"password-form"},on={class:"form-group"},rn={class:"form-group"},dn={class:"form-group"},un={class:"form-actions"},cn=["disabled"],vn={__name:"UserManage",setup(m){const s=_(""),l=_(""),V=_(""),a=_(!1),h=_(""),P=_("success"),D=_({}),p=_(""),n=_(!1),y=_(""),f=_("success");le(()=>B(null,null,function*(){yield M()}));function M(){return B(this,null,function*(){try{const A=yield gs();D.value=A.data.data||A.data}catch(A){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",A)}})}function b(){return B(this,null,function*(){var A,C;if(!p.value){c("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(p.value.length<3||p.value.length>20){c("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(p.value===D.value.username){c("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}n.value=!0,y.value="";try{yield hs(p.value),c("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),p.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(x){c(((C=(A=x.response)==null?void 0:A.data)==null?void 0:C.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{n.value=!1}})}function c(A,C){y.value=A,f.value=C,setTimeout(()=>{y.value=""},3e3)}function v(){return B(this,null,function*(){var A,C;if(!s.value||!l.value||!V.value){r("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(l.value!==V.value){r("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(l.value.length<6){r("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}a.value=!0,h.value="";try{yield fs(s.value,l.value),r("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),s.value="",l.value="",V.value=""}catch(x){r(((C=(A=x.response)==null?void 0:A.data)==null?void 0:C.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{a.value=!1}})}function r(A,C){h.value=A,P.value=C,A==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&C==="success"?setTimeout(()=>{h.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{h.value=""},3e3)}return(A,C)=>(o(),i("div",Jl,[C[11]||(C[11]=e("div",{class:"user-header"},null,-1)),e("div",Ql,[e("div",Xl,[C[6]||(C[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",Yl,[e("div",Zl,[C[4]||(C[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",en,u(D.value.username||"admin"),1)]),e("div",sn,[C[5]||(C[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[0]||(C[0]=x=>p.value=x),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[L,p.value]])]),e("div",tn,[e("button",{onClick:b,class:"btn",disabled:n.value},u(n.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,an)]),y.value?(o(),i("p",{key:0,class:W(["message",f.value])},u(y.value),3)):K("",!0)])]),e("div",ln,[C[10]||(C[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",nn,[e("div",on,[C[7]||(C[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[1]||(C[1]=x=>s.value=x),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[L,s.value]])]),e("div",rn,[C[8]||(C[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[2]||(C[2]=x=>l.value=x),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,l.value]])]),e("div",dn,[C[9]||(C[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),U(e("input",{"onUpdate:modelValue":C[3]||(C[3]=x=>V.value=x),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,V.value]])]),e("div",un,[e("button",{onClick:v,class:"btn",disabled:a.value},u(a.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,cn)]),h.value?(o(),i("p",{key:0,class:W(["message",P.value])},u(h.value),3)):K("",!0)])])])]))}},pn=Y(vn,[["__scopeId","data-v-40392133"]]),mn={class:"backup-manage"},gn={class:"tabs"},hn={class:"tab-content"},fn={class:"toolbar"},bn=["disabled"],yn=["disabled"],wn=["disabled"],kn={class:"backup-list"},_n={key:0,class:"empty-state"},$n={key:1,class:"backup-grid"},Cn={class:"backup-info"},Mn={class:"backup-name"},xn={class:"backup-meta"},Un={class:"backup-size"},An={class:"backup-date"},Bn={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Vn={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},Tn={class:"backup-actions"},Dn=["onClick"],In=["onClick"],Pn=["onClick"],Sn=["onClick"],Ln={class:"tab-content"},Kn={class:"toolbar"},Nn=["disabled"],Wn=["disabled"],Rn={key:1,class:"info-box"},zn={class:"backup-list"},En={key:0,class:"empty-state"},On={key:1,class:"backup-grid"},qn={class:"backup-info"},Hn={class:"backup-name"},Fn={class:"backup-meta"},Gn={class:"backup-size"},jn={class:"backup-date"},Jn={class:"backup-actions"},Qn=["onClick"],Xn=["onClick"],Yn={class:"tab-content"},Zn={class:"config-section"},eo={class:"config-card"},so={class:"config-header"},to={class:"switch"},ao={key:0,class:"config-fields"},lo={class:"field-row"},no={class:"field-row"},oo={class:"config-card"},io={class:"config-header"},ro={class:"switch"},uo={key:0,class:"config-fields"},co={class:"field-row"},vo={class:"time-input"},po={class:"field-row"},mo={class:"field-row checkbox-row"},go={class:"checkbox-label"},ho={class:"config-card"},fo={class:"config-header"},bo={class:"switch"},yo={class:"config-info"},wo={key:0,class:"warning-text"},ko={key:0,class:"config-fields"},_o={class:"field-row checkbox-row"},$o={class:"checkbox-label"},Co={class:"field-row checkbox-row"},Mo={class:"checkbox-label"},xo={class:"config-card"},Uo={class:"config-header"},Ao={class:"switch"},Bo={key:0,class:"stats-card"},Vo={class:"stats-grid"},To={class:"stat-item"},Do={class:"stat-value"},Io={class:"stat-item"},Po={class:"stat-value"},So={class:"stat-item"},Lo={class:"stat-value"},Ko={class:"stat-item"},No={class:"stat-value"},Wo={class:"config-actions"},Ro=["disabled"],zo={key:0,class:"modal-overlay"},Eo={class:"modal-content config-modal"},Oo={class:"form-group"},qo={class:"form-group"},Ho={class:"form-group"},Fo=["placeholder"],Go={key:0},jo={key:1},Jo={class:"modal-actions"},Qo=["disabled"],Xo={key:1,class:"modal-overlay"},Yo={class:"modal-content"},Zo={style:{"white-space":"pre-line"}},ei={class:"modal-actions"},si=["disabled"],ti=["disabled"],ai={key:2,class:"modal-overlay"},li={class:"modal-content config-modal"},ni={class:"form-group"},oi={class:"form-group"},ii={class:"modal-actions"},ri=["disabled"],di={key:3,class:"modal-overlay"},ui={class:"modal-content config-modal"},ci={class:"form-group"},vi={class:"modal-actions"},pi=["disabled"],mi={__name:"BackupManage",setup(m){const s=_("local"),l=_([]),V=_([]),a=_(!1),h=_(!1),P=_(!1),D=_(null),p=ne({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),n=ne({name:"",description:""}),y=ne({oldName:"",newName:""}),f=_({text:"",type:""}),M=ne({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),b=ne({configured:!1,url:"",username:""}),c=ne({url:"",username:"",password:""}),v=ne({debounce:{enabled:!0,delay:5,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),r=_(null),A=localStorage.getItem("token");function C(q){return B(this,arguments,function*(w,t={}){return(yield fetch(w,ke(he({},t),{headers:he({Authorization:`Bearer ${A}`,"Content-Type":"application/json"},t.headers)}))).json()})}const x=(w,t="success",q=4e3)=>{f.value={text:w,type:t},setTimeout(()=>{f.value={text:"",type:""}},t==="error"?6e3:q)};function O(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[å¤‡ä»½ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(w){console.warn("[å¤‡ä»½ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",w)}}function J(){return B(this,null,function*(){try{const w=yield C("/api/ai/config/verify");w.success&&(w.status==="decrypt_failed"?(x("âš ï¸ AI é…ç½®æ¢å¤å¼‚å¸¸ï¼šAPI Key è§£å¯†å¤±è´¥ï¼Œè¯·å‰å¾€ AI è®¾ç½®é‡æ–°é…ç½®","warning",8e3),setTimeout(()=>{confirm(`AI é…ç½®çš„ API Key è§£å¯†å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤‡ä»½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨ã€‚

æ˜¯å¦ç°åœ¨å‰å¾€ AI è®¾ç½®é¡µé¢é‡æ–°é…ç½®ï¼Ÿ`)&&(window.location.href="/admin/ai-settings")},1e3)):w.status==="ok"&&console.log("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯é€šè¿‡"))}catch(w){console.warn("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯å¤±è´¥:",w)}})}const Z=()=>{n.name="",n.description="",h.value=!0},ee=()=>B(null,null,function*(){p.create=!0;const w=yield C("/api/backup/create",{method:"POST",body:JSON.stringify({name:n.name||null,description:n.description||null})});w.success?(x("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),h.value=!1,yield R()):x(w.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),p.create=!1}),te=w=>{y.oldName=w,y.newName=w.replace(".zip",""),P.value=!0},se=()=>B(null,null,function*(){if(!y.newName.trim()){x("è¯·è¾“å…¥æ–°åç§°","error");return}p.rename=!0;const w=yield C(`/api/backup/rename/${y.oldName}`,{method:"PUT",body:JSON.stringify({newName:y.newName})});w.success?(x("é‡å‘½åæˆåŠŸï¼"),P.value=!1,yield R()):x(w.message||"é‡å‘½åå¤±è´¥","error"),p.rename=!1}),R=()=>B(null,null,function*(){p.list=!0;const w=yield C("/api/backup/list");w.success?l.value=w.backups:x("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),p.list=!1}),N=w=>{window.open(`/api/backup/download/${w}?token=${A}`,"_blank")},k=(w,t)=>{const q=typeof t=="object"?t:{name:t},$=q.name;M.show=!0,M.filename=$,M.action=w,M.signed=q.signed,M.processing=!1,w==="delete"?(M.title="åˆ é™¤",M.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${$} å—ï¼Ÿ`,M.confirmClass="btn-danger"):w==="restore"?(M.title="æ¢å¤",q.signed?M.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${$} å—ï¼Ÿ`:M.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${$} å—ï¼Ÿ`,M.confirmClass="btn-restore"):w==="webdav-restore"?(M.title="ä»WebDAVæ¢å¤",M.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${$} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,M.confirmClass="btn-restore"):w==="webdav-delete"&&(M.title="åˆ é™¤WebDAVå¤‡ä»½",M.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${$} å—ï¼Ÿ`,M.confirmClass="btn-danger")},T=()=>B(null,null,function*(){const{action:w,filename:t,signed:q}=M;M.show=!1,M.processing=!1;try{if(w==="delete"){x("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const $=yield C(`/api/backup/delete/${t}`,{method:"DELETE"});$.success?(x("âœ“ åˆ é™¤æˆåŠŸ"),yield R()):x("âœ— "+($.message||"åˆ é™¤å¤±è´¥"),"error")}else if(w==="restore"){x("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const $=q?{}:{forceRestore:!0},G=yield C(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify($)});if(G.success)x("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(de=>setTimeout(de,2e3)),yield Promise.all([R(),j(),Q(),S()]),O(),G.checkAIConfig&&(yield J()),x("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(G.requireConfirm&&G.code==="NO_SIGNATURE"){if(confirm(G.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const de=yield C(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});de.success?(x("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ze=>setTimeout(ze,2e3)),yield Promise.all([R(),j(),Q(),S()]),O(),de.checkAIConfig&&(yield J()),x("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):x("âœ— "+(de.message||"æ¢å¤å¤±è´¥"),"error")}}else x("âœ— "+(G.message||"æ¢å¤å¤±è´¥"),"error")}else w==="webdav-restore"?yield me(t):w==="webdav-delete"&&(yield ge(t))}catch($){x("âœ— æ“ä½œå¤±è´¥: "+$.message,"error")}}),I=w=>w?new Date(w).toLocaleString("zh-CN",{hour12:!1}):"--",g=()=>{D.value.click()},d=w=>B(null,null,function*(){const t=w.target.files[0];if(t){if(!t.name.endsWith(".zip")){x("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),w.target.value="";return}if(t.size>500*1024*1024){x("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),w.target.value="";return}p.upload=!0;try{const q=new FormData;q.append("backup",t);const G=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${A}`},body:q})).json();G.success?(x("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield R()):x(G.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(q){console.error("ä¸Šä¼ å¤±è´¥:",q),x("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{p.upload=!1,w.target.value=""}}}),j=()=>B(null,null,function*(){const w=yield C("/api/backup/webdav/config");w.success&&w.config&&(b.configured=w.config.configured,b.url=w.config.url||"",b.username=w.config.username||"")}),ue=()=>B(null,null,function*(){yield j(),c.url=b.url,c.username=b.username,c.password="",a.value=!0}),ce=()=>B(null,null,function*(){if(!c.url||!c.username){x("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!b.configured&&!c.password){x("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}p.webdavConfig=!0;const w=yield C("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(c)});w.success?(a.value=!1,yield j(),b.configured?(yield Q(),yield S(),v.webdav.enabled?x("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"):(v.webdav.enabled=!0,(yield C("/api/backup/auto/config",{method:"POST",body:JSON.stringify(v)})).success?x("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œå·²è‡ªåŠ¨å¼€å¯WebDAVè‡ªåŠ¨åŒæ­¥ï¼"):x("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œä½†è‡ªåŠ¨åŒæ­¥å¼€å¯å¤±è´¥","error"))):x("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼")):x(w.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),p.webdavConfig=!1}),ve=()=>B(null,null,function*(){p.webdavBackup=!0;const w=yield C("/api/backup/webdav/backup",{method:"POST"});w.success?(x("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield Q()):(x(w.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),w.needReconfigure&&(b.configured=!1,b.url="",b.username="")),p.webdavBackup=!1}),pe=w=>{w.target.checked&&!b.configured&&(v.webdav.enabled=!1,x('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),s.value="webdav")},Q=()=>B(null,null,function*(){p.webdavList=!0;const w=yield C("/api/backup/webdav/list");w.success?(V.value=w.backups||[],w.configured===!1&&(b.configured=!1,b.url="",b.username="",w.message&&x(w.message,"error"))):x(w.message||"è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),p.webdavList=!1}),me=w=>B(null,null,function*(){x("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),p.webdavRestore=!0;try{const t=yield C("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:w})});t.success?(x("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(q=>setTimeout(q,2e3)),yield Promise.all([R(),j(),Q(),S()]),O(),t.checkAIConfig&&(yield J()),x("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):(x("âœ— "+(t.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error"),t.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(t){x("âœ— æ¢å¤å¤±è´¥: "+t.message,"error")}finally{p.webdavRestore=!1}}),ge=w=>B(null,null,function*(){x("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),p.webdavDelete=!0;try{const t=yield C(`/api/backup/webdav/delete/${w}`,{method:"DELETE"});t.success?(x("âœ“ åˆ é™¤æˆåŠŸ"),yield Q()):(x("âœ— "+(t.message||"åˆ é™¤å¤±è´¥"),"error"),t.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(t){x("âœ— åˆ é™¤å¤±è´¥: "+t.message,"error")}finally{p.webdavDelete=!1}}),S=()=>B(null,null,function*(){const w=yield C("/api/backup/auto/config");w.success&&w.config?(Object.assign(v,w.config),r.value=w.stats||null):x("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),E=()=>B(null,null,function*(){p.autoBackupConfig=!0;const w=yield C("/api/backup/auto/config",{method:"POST",body:JSON.stringify(v)});w.success?(x("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield S()):x(w.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),p.autoBackupConfig=!1}),We=()=>{if(!v.scheduled.enabled)return"æœªå¯ç”¨";const w=String(v.scheduled.hour).padStart(2,"0"),t=String(v.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${w}:${t}`},Re=()=>{confirm("ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é…ç½®å—ï¼Ÿè¿™å°†é‡ç½®æ‰€æœ‰è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚")&&(v.debounce={enabled:!0,delay:5,keep:5},v.scheduled={enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},v.webdav={enabled:!1,syncDaily:!0,syncIncremental:!0},v.autoClean=!0,x('å·²æ¢å¤é»˜è®¤é…ç½®ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"ä»¥ç”Ÿæ•ˆ'))};return le(()=>B(null,null,function*(){yield R(),yield j(),b.configured&&(yield Q()),yield S()})),(w,t)=>{var q;return o(),i("div",mn,[e("div",gn,[e("button",{class:W(["tab",{active:s.value==="local"}]),onClick:t[0]||(t[0]=$=>s.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:W(["tab",{active:s.value==="webdav"}]),onClick:t[1]||(t[1]=$=>s.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:W(["tab",{active:s.value==="auto"}]),onClick:t[2]||(t[2]=$=>s.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),U(e("div",hn,[e("div",fn,[e("button",{class:"btn btn-primary",onClick:Z,disabled:p.create},[t[25]||(t[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+u(p.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,bn),e("button",{class:"btn btn-success",onClick:g,disabled:p.upload},[t[26]||(t[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),z(" "+u(p.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,yn),e("button",{class:"btn btn-secondary",onClick:R,disabled:p.list},[t[27]||(t[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+u(p.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,wn),e("input",{ref_key:"fileInput",ref:D,type:"file",accept:".zip",onChange:d,style:{display:"none"}},null,544)]),f.value.text?(o(),i("div",{key:0,class:W(["message",f.value.type])},u(f.value.text),3)):K("",!0),e("div",kn,[l.value.length===0&&!p.list?(o(),i("div",_n,[...t[28]||(t[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(o(),i("div",$n,[(o(!0),i(H,null,F(l.value,$=>(o(),i("div",{key:$.name,class:"backup-card"},[t[33]||(t[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Cn,[e("div",Mn,u($.name),1),e("div",xn,[e("span",Un,u($.size),1),e("span",An,u(I($.created)),1),$.signed?(o(),i("span",Bn,"ğŸ”’")):(o(),i("span",Vn,"âš ï¸"))])]),e("div",Tn,[e("button",{class:"btn-icon btn-restore",onClick:G=>k("restore",$),title:"æ¢å¤å¤‡ä»½"},[...t[29]||(t[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Dn),e("button",{class:"btn-icon btn-rename",onClick:G=>te($.name),title:"é‡å‘½å"},[...t[30]||(t[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,In),e("button",{class:"btn-icon",onClick:G=>N($.name),title:"ä¸‹è½½å¤‡ä»½"},[...t[31]||(t[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Pn),e("button",{class:"btn-icon btn-danger",onClick:G=>k("delete",$.name),title:"åˆ é™¤å¤‡ä»½"},[...t[32]||(t[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Sn)])]))),128))]))])],512),[[be,s.value==="local"]]),U(e("div",Ln,[e("div",Kn,[e("button",{class:"btn btn-primary",onClick:ue},[...t[34]||(t[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),z(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ve,disabled:p.webdavBackup||!b.configured},[t[35]||(t[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),z(" "+u(p.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Nn),e("button",{class:"btn btn-secondary",onClick:Q,disabled:p.webdavList||!b.configured},[t[36]||(t[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),z(" "+u(p.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Wn)]),f.value.text?(o(),i("div",{key:0,class:W(["message",f.value.type])},u(f.value.text),3)):K("",!0),b.configured?K("",!0):(o(),i("div",Rn,[...t[37]||(t[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",zn,[V.value.length===0&&!p.webdavList?(o(),i("div",En,[...t[38]||(t[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(o(),i("div",On,[(o(!0),i(H,null,F(V.value,$=>(o(),i("div",{key:$.name,class:"backup-card"},[t[41]||(t[41]=re('<div class="backup-icon" data-v-19fdb4a7><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-19fdb4a7><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-19fdb4a7></path><polyline points="14 2 14 8 20 8" data-v-19fdb4a7></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-19fdb4a7></path></svg></div>',1)),e("div",qn,[e("div",Hn,u($.name),1),e("div",Fn,[e("span",Gn,u($.size),1),e("span",jn,u(I($.created)),1)])]),e("div",Jn,[e("button",{class:"btn-icon btn-restore",onClick:G=>k("webdav-restore",$.name),title:"ä»WebDAVæ¢å¤"},[...t[39]||(t[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Qn),e("button",{class:"btn-icon btn-danger",onClick:G=>k("webdav-delete",$.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...t[40]||(t[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Xn)])]))),128))]))])],512),[[be,s.value==="webdav"]]),U(e("div",Yn,[f.value.text?(o(),i("div",{key:0,class:W(["message",f.value.type])},u(f.value.text),3)):K("",!0),e("div",Zn,[t[76]||(t[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),t[77]||(t[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",eo,[e("div",so,[t[43]||(t[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",to,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=$=>v.debounce.enabled=$)},null,512),[[ae,v.debounce.enabled]]),t[42]||(t[42]=e("span",{class:"slider"},null,-1))])]),t[48]||(t[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),v.debounce.enabled?(o(),i("div",ao,[e("div",lo,[t[44]||(t[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),U(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=$=>v.debounce.delay=$),min:"5",max:"1440",class:"form-input"},null,512),[[L,v.debounce.delay,void 0,{number:!0}]]),t[45]||(t[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",no,[t[46]||(t[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),U(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=$=>v.debounce.keep=$),min:"1",max:"30",class:"form-input"},null,512),[[L,v.debounce.keep,void 0,{number:!0}]]),t[47]||(t[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):K("",!0)]),e("div",oo,[e("div",io,[t[50]||(t[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",ro,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=$=>v.scheduled.enabled=$)},null,512),[[ae,v.scheduled.enabled]]),t[49]||(t[49]=e("span",{class:"slider"},null,-1))])]),t[58]||(t[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),v.scheduled.enabled?(o(),i("div",uo,[e("div",co,[t[52]||(t[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",vo,[U(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=$=>v.scheduled.hour=$),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[L,v.scheduled.hour,void 0,{number:!0}]]),t[51]||(t[51]=e("span",null,":",-1)),U(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=$=>v.scheduled.minute=$),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[L,v.scheduled.minute,void 0,{number:!0}]])]),t[53]||(t[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",po,[t[54]||(t[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),U(e("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=$=>v.scheduled.keep=$),min:"1",max:"30",class:"form-input"},null,512),[[L,v.scheduled.keep,void 0,{number:!0}]]),t[55]||(t[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",mo,[e("label",go,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=$=>v.scheduled.onlyIfModified=$)},null,512),[[ae,v.scheduled.onlyIfModified]]),t[56]||(t[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),t[57]||(t[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):K("",!0)]),e("div",ho,[e("div",fo,[t[60]||(t[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",bo,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=$=>v.webdav.enabled=$),onChange:pe},null,544),[[ae,v.webdav.enabled]]),t[59]||(t[59]=e("span",{class:"slider"},null,-1))])]),e("p",yo,[t[61]||(t[61]=z(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),b.configured?K("",!0):(o(),i("span",wo,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),v.webdav.enabled?(o(),i("div",ko,[e("div",_o,[e("label",$o,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=$=>v.webdav.syncDaily=$)},null,512),[[ae,v.webdav.syncDaily]]),t[62]||(t[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),t[63]||(t[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Co,[e("label",Mo,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=$=>v.webdav.syncIncremental=$)},null,512),[[ae,v.webdav.syncIncremental]]),t[64]||(t[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),t[65]||(t[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):K("",!0)]),e("div",xo,[e("div",Uo,[t[67]||(t[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Ao,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=$=>v.autoClean=$)},null,512),[[ae,v.autoClean]]),t[66]||(t[66]=e("span",{class:"slider"},null,-1))])]),t[68]||(t[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),r.value?(o(),i("div",Bo,[t[73]||(t[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Vo,[e("div",To,[t[69]||(t[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Do,u(((q=r.value.incremental)==null?void 0:q.count)||0)+" ä¸ª",1)]),e("div",Io,[t[70]||(t[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",Po,u(I(r.value.lastDebounce)||"æ— "),1)]),e("div",So,[t[71]||(t[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Lo,u(I(r.value.lastScheduled)||"æ— "),1)]),e("div",Ko,[t[72]||(t[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",No,u(We()),1)])])])):K("",!0),e("div",Wo,[e("button",{class:"btn btn-secondary",onClick:Re},[...t[74]||(t[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),z(" æ¢å¤é»˜è®¤ ",-1)])]),e("button",{class:"btn btn-primary",onClick:E,disabled:p.autoBackupConfig},[t[75]||(t[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),z(" "+u(p.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Ro)])])],512),[[be,s.value==="auto"]]),a.value?(o(),i("div",zo,[e("div",Eo,[t[82]||(t[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",Oo,[t[78]||(t[78]=e("label",null,[z("WebDAV URL "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=$=>c.url=$),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[L,c.url]]),t[79]||(t[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",qo,[t[80]||(t[80]=e("label",null,[z("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":t[16]||(t[16]=$=>c.username=$),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[L,c.username]])]),e("div",Ho,[t[81]||(t[81]=e("label",null,[z("å¯†ç  "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"password","onUpdate:modelValue":t[17]||(t[17]=$=>c.password=$),placeholder:b.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,Fo),[[L,c.password]]),b.configured?(o(),i("small",jo,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(o(),i("small",Go,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",Jo,[e("button",{class:"btn btn-secondary",onClick:t[18]||(t[18]=$=>a.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ce,disabled:p.webdavConfig},u(p.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,Qo)])])])):K("",!0),M.show?(o(),i("div",Xo,[e("div",Yo,[e("h3",null,"ç¡®è®¤"+u(M.title),1),e("p",Zo,u(M.message),1),e("div",ei,[e("button",{class:"btn btn-secondary",onClick:t[19]||(t[19]=$=>M.show=!1),disabled:M.processing},"å–æ¶ˆ",8,si),e("button",{class:W(["btn",M.confirmClass]),onClick:T,disabled:M.processing},u(M.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,ti)])])])):K("",!0),h.value?(o(),i("div",ai,[e("div",li,[t[86]||(t[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",ni,[t[83]||(t[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),U(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=$=>n.name=$),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[L,n.name]]),t[84]||(t[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",oi,[t[85]||(t[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),U(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=$=>n.description=$),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[L,n.description]])]),e("div",ii,[e("button",{class:"btn btn-secondary",onClick:t[22]||(t[22]=$=>h.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ee,disabled:p.create},u(p.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,ri)])])])):K("",!0),P.value?(o(),i("div",di,[e("div",ui,[t[88]||(t[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",ci,[t[87]||(t[87]=e("label",null,[z("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),U(e("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=$=>y.newName=$),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[L,y.newName]]),e("small",null,"åŸåç§°ï¼š"+u(y.oldName),1)]),e("div",vi,[e("button",{class:"btn btn-secondary",onClick:t[24]||(t[24]=$=>P.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:p.rename||!y.newName.trim()},u(p.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,pi)])])])):K("",!0)])}}},gi=Y(mi,[["__scopeId","data-v-19fdb4a7"]]);function Te(){const m=localStorage.getItem("token");return m?{Authorization:`Bearer ${m}`}:{}}const X={get:m=>oe.get(m,{headers:Te()}),post:(m,s)=>oe.post(m,s,{headers:Te()})},$e={deepseek:{name:"DeepSeek",icon:"ğŸ”®",recommended:!0,needsApiKey:!0,needsBaseUrl:!1,defaultModel:"deepseek-chat",models:["deepseek-chat","deepseek-coder"],defaultBaseUrl:"https://api.deepseek.com",docsUrl:"https://platform.deepseek.com/api_keys"},openai:{name:"OpenAI",icon:"ğŸ¤–",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gpt-4o-mini",models:["gpt-4o-mini","gpt-4o","gpt-4-turbo","gpt-3.5-turbo"],defaultBaseUrl:"https://api.openai.com",docsUrl:"https://platform.openai.com/api-keys"},anthropic:{name:"Claude",icon:"ğŸ§ ",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"claude-3-haiku-20240307",models:["claude-3-5-sonnet-20241022","claude-3-haiku-20240307"],defaultBaseUrl:"",docsUrl:"https://console.anthropic.com/settings/keys"},gemini:{name:"Gemini",icon:"ğŸ’",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gemini-1.5-flash",models:["gemini-1.5-flash","gemini-1.5-pro","gemini-2.0-flash-exp"],defaultBaseUrl:"",docsUrl:"https://aistudio.google.com/app/apikey"},zhipu:{name:"æ™ºè°± GLM",icon:"ğŸ‡¨ğŸ‡³",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"glm-4-flash",models:["glm-4-flash","glm-4-air","glm-4"],defaultBaseUrl:"",docsUrl:"https://open.bigmodel.cn/usercenter/apikeys"},qwen:{name:"é€šä¹‰åƒé—®",icon:"â˜ï¸",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"qwen-turbo",models:["qwen-turbo","qwen-plus","qwen-max"],defaultBaseUrl:"",docsUrl:"https://dashscope.console.aliyun.com/apiKey"},moonshot:{name:"Kimi",icon:"ğŸŒ™",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"moonshot-v1-8k",models:["moonshot-v1-8k","moonshot-v1-32k","moonshot-v1-128k"],defaultBaseUrl:"",docsUrl:"https://platform.moonshot.cn/console/api-keys"},groq:{name:"Groq",icon:"âš¡",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"llama-3.1-8b-instant",models:["llama-3.1-8b-instant","llama-3.1-70b-versatile","mixtral-8x7b-32768"],defaultBaseUrl:"",docsUrl:"https://console.groq.com/keys"},doubao:{name:"è±†åŒ…",icon:"ğŸ«˜",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"doubao-lite-4k",models:["doubao-lite-4k","doubao-pro-4k"],defaultBaseUrl:"",docsUrl:"https://console.volcengine.com/ark"},ollama:{name:"Ollama",icon:"ğŸ¦™",local:!0,needsApiKey:!1,needsBaseUrl:!0,defaultModel:"llama3.2",models:["llama3.2","llama3.1","mistral","qwen2.5"],defaultBaseUrl:"http://localhost:11434",docsUrl:"https://ollama.com/"},custom:{name:"è‡ªå®šä¹‰",icon:"âš™ï¸",needsApiKey:!0,needsBaseUrl:!0,defaultModel:"",models:[],defaultBaseUrl:"",docsUrl:""}},hi={name:"AISettings",data(){return{providers:$e,config:{provider:"deepseek",apiKey:"",baseUrl:"",model:"",requestDelay:1500,autoGenerate:!1,hasApiKey:!1},selectedModel:"",showApiKey:!1,showAdvanced:!1,testing:!1,saving:!1,refreshing:!1,starting:!1,stopping:!1,connectionTested:!1,connectionOk:!1,stats:null,batchRunning:!1,batchType:"",batchMode:"",batchProgress:{current:0,total:0,currentCard:"",concurrency:3,isRateLimited:!1},batchStartTime:null,pollTimer:null,message:"",messageType:"info"}},computed:{currentProvider(){return $e[this.config.provider]||$e.deepseek},needsApiKey(){return this.currentProvider.needsApiKey},needsBaseUrl(){return this.currentProvider.needsBaseUrl},canTest(){return!(this.needsApiKey&&!this.config.apiKey&&!this.config.hasApiKey||this.needsBaseUrl&&!this.config.baseUrl&&!this.currentProvider.defaultBaseUrl)},connectionStatus(){return!this.config.hasApiKey&&!this.config.apiKey?"unconfigured":this.connectionTested?this.connectionOk?"connected":"error":"unknown"},statusText(){return{unconfigured:"æœªé…ç½®",connected:"å·²è¿æ¥",error:"è¿æ¥å¤±è´¥",unknown:"å¾…æµ‹è¯•"}[this.connectionStatus]},progressPercent(){return this.batchProgress.total?Math.round(this.batchProgress.current/this.batchProgress.total*100):0},batchLabel(){const s={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾",all:"å…¨éƒ¨å†…å®¹"}[this.batchType]||"å†…å®¹";return`æ­£åœ¨${this.batchMode==="all"?"é‡æ–°ç”Ÿæˆ":"è¡¥å……"}${s}`},totalMissing(){return this.stats?this.stats.emptyName+this.stats.emptyDesc+this.stats.emptyTags:0},estimatedTime(){if(!this.batchStartTime||!this.batchProgress.current||this.batchProgress.current<2)return"";const s=(Date.now()-this.batchStartTime)/this.batchProgress.current,l=(this.batchProgress.total-this.batchProgress.current)*s;return l<6e4?`${Math.round(l/1e3)}ç§’`:`${Math.round(l/6e4)}åˆ†é’Ÿ`},messageIcon(){return{success:"âœ…",error:"âŒ",info:"â„¹ï¸",warning:"âš ï¸"}[this.messageType]||"â„¹ï¸"},concurrencyText(){if(this.batchProgress.isRateLimited)return"æ£€æµ‹åˆ°é™æµï¼Œå·²é™é€Ÿ";const m=this.batchProgress.concurrency||1;return m>=4?"é«˜é€Ÿå¹¶è¡Œå¤„ç†ä¸­":m>=2?"å¹¶è¡Œå¤„ç†ä¸­":"ä¸²è¡Œå¤„ç†ä¸­"},concurrencyClass(){if(this.batchProgress.isRateLimited)return"rate-limited";const m=this.batchProgress.concurrency||1;return m>=4?"high":m>=2?"medium":"low"}},mounted(){return B(this,null,function*(){yield this.loadConfig(),yield this.refreshStats(),yield this.checkRunningTask()})},beforeUnmount(){this.stopPolling()},methods:{selectProvider(m){this.config.provider!==m&&(this.config.provider=m,this.config.apiKey="",this.config.hasApiKey=!1,this.config.baseUrl="",this.selectedModel="",this.config.model="",this.connectionTested=!1)},onModelChange(){this.selectedModel&&(this.config.model=this.selectedModel)},pasteApiKey(){return B(this,null,function*(){try{const m=yield navigator.clipboard.readText();m&&(this.config.apiKey=m.trim(),this.showMessage("å·²ç²˜è´´","success"))}catch(m){this.showMessage("æ— æ³•è®¿é—®å‰ªè´´æ¿","error")}})},stopPolling(){this.pollTimer&&(clearTimeout(this.pollTimer),this.pollTimer=null)},loadConfig(){return B(this,null,function*(){var m;try{const s=yield X.get("/api/ai/config");if(s.data.success){const l=s.data.config;this.config.provider=l.provider||"deepseek",this.config.hasApiKey=l.hasApiKey,this.config.baseUrl=l.baseUrl||"",this.config.model=l.model||"",this.config.requestDelay=l.requestDelay||1500,this.config.autoGenerate=l.autoGenerate||!1,l.model&&((m=this.currentProvider.models)!=null&&m.includes(l.model))&&(this.selectedModel=l.model)}}catch(s){}})},checkRunningTask(){return B(this,null,function*(){try{const m=yield X.get("/api/ai/batch-task/status");m.data.success&&m.data.running&&(this.batchRunning=!0,this.batchType=m.data.type,this.batchMode=m.data.mode,this.batchProgress={current:m.data.current||0,total:m.data.total||0,currentCard:m.data.currentCard||""},this.batchStartTime=Date.now()-m.data.current*2e3,this.startPolling())}catch(m){}})},saveConfig(){return B(this,null,function*(){var m,s;this.saving=!0;try{const l=yield X.post("/api/ai/config",{provider:this.config.provider,apiKey:this.config.apiKey||void 0,baseUrl:this.config.baseUrl||this.currentProvider.defaultBaseUrl,model:this.config.model||this.currentProvider.defaultModel,requestDelay:this.config.requestDelay,autoGenerate:this.config.autoGenerate});l.data.success?(this.showMessage("é…ç½®ä¿å­˜æˆåŠŸ","success"),this.config.hasApiKey=!0,this.config.apiKey="",setTimeout(()=>this.testConnection(),500)):this.showMessage(l.data.message,"error")}catch(l){this.showMessage(((s=(m=l.response)==null?void 0:m.data)==null?void 0:s.message)||"ä¿å­˜å¤±è´¥","error")}finally{this.saving=!1}})},testConnection(){return B(this,null,function*(){var m,s;this.testing=!0,this.connectionTested=!1;try{const l=yield X.post("/api/ai/test");this.connectionTested=!0,l.data.success?(this.connectionOk=!0,this.showMessage("è¿æ¥æˆåŠŸ","success")):(this.connectionOk=!1,this.showMessage(l.data.message,"error"))}catch(l){this.connectionTested=!0,this.connectionOk=!1,this.showMessage(((s=(m=l.response)==null?void 0:m.data)==null?void 0:s.message)||"è¿æ¥å¤±è´¥","error")}finally{this.testing=!1}})},refreshStats(){return B(this,null,function*(){if(!this.refreshing){this.refreshing=!0;try{const[m,s,l,V]=yield Promise.all([X.get("/api/ai/empty-cards?type=name"),X.get("/api/ai/empty-cards?type=description"),X.get("/api/ai/empty-cards?type=tags"),X.get("/api/ai/empty-cards?type=description&mode=all")]);this.stats={emptyName:m.data.total||0,emptyDesc:s.data.total||0,emptyTags:l.data.total||0,total:V.data.total||0}}catch(m){}finally{this.refreshing=!1}}})},startBatchAll(){return B(this,null,function*(){var s,l,V;if(this.starting||this.batchRunning)return;const m=[];if(((s=this.stats)==null?void 0:s.emptyName)>0&&m.push({type:"name",count:this.stats.emptyName}),((l=this.stats)==null?void 0:l.emptyDesc)>0&&m.push({type:"description",count:this.stats.emptyDesc}),((V=this.stats)==null?void 0:V.emptyTags)>0&&m.push({type:"tags",count:this.stats.emptyTags}),m.length===0){this.showMessage("æ²¡æœ‰éœ€è¦è¡¥å……çš„å†…å®¹","info");return}yield this.startBatch(m[0].type,"empty")})},startBatch(m,s){return B(this,null,function*(){var l,V;if(!(this.starting||this.batchRunning)){if(s==="all"){const h=`ç¡®å®šè¦é‡æ–°ç”Ÿæˆæ‰€æœ‰å¡ç‰‡çš„${{name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"}[m]}å—ï¼Ÿè¿™å°†è¦†ç›–ç°æœ‰å†…å®¹ã€‚`;if(!confirm(h))return}this.starting=!0,this.stopPolling();try{const a=yield X.post("/api/ai/batch-task/start",{type:m,mode:s});if(!a.data.success){this.showMessage(a.data.message||"å¯åŠ¨ä»»åŠ¡å¤±è´¥","error");return}if(a.data.total===0){this.showMessage("æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡","info"),yield this.refreshStats();return}this.batchType=m,this.batchMode=s,this.batchProgress={current:0,total:a.data.total,currentCard:"æ­£åœ¨åˆå§‹åŒ–...",concurrency:a.data.initialConcurrency||3,isRateLimited:!1},this.batchRunning=!0,this.batchStartTime=Date.now();const h={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"};this.showMessage(`å¼€å§‹ç”Ÿæˆ${h[m]}ï¼Œå…± ${a.data.total} ä¸ªå¡ç‰‡`,"success"),this.startPolling()}catch(a){this.showMessage(((V=(l=a.response)==null?void 0:l.data)==null?void 0:V.message)||"å¯åŠ¨ä»»åŠ¡å¤±è´¥","error")}finally{this.starting=!1}}})},startPolling(){const m=()=>B(this,null,function*(){if(!this.batchRunning){this.stopPolling();return}try{const s=yield X.get("/api/ai/batch-task/status");if(!s.data.success){this.pollTimer=setTimeout(m,1500);return}s.data.total>0&&(this.batchProgress.current=s.data.current||0,this.batchProgress.total=s.data.total,this.batchProgress.currentCard=s.data.currentCard||"å¤„ç†ä¸­...",this.batchProgress.concurrency=s.data.concurrency||1,this.batchProgress.isRateLimited=s.data.isRateLimited||!1),s.data.running?this.pollTimer=setTimeout(m,800):this.onTaskComplete(s.data)}catch(s){console.error("è½®è¯¢é”™è¯¯:",s),this.pollTimer=setTimeout(m,2e3)}});m()},onTaskComplete(m){this.stopPolling(),this.batchRunning=!1,this.batchStartTime=null;const s=m.successCount||0,l=m.total||this.batchProgress.total;l>0?this.showMessage(`å®Œæˆï¼æˆåŠŸå¤„ç† ${s} / ${l} ä¸ªå¡ç‰‡`,"success"):this.showMessage("ä»»åŠ¡å·²å®Œæˆ","success"),setTimeout(()=>this.refreshStats(),300)},stopBatch(){return B(this,null,function*(){if(!this.stopping){this.stopping=!0;try{yield X.post("/api/ai/batch-task/stop"),this.showMessage("æ­£åœ¨åœæ­¢ä»»åŠ¡...","info")}catch(m){}finally{setTimeout(()=>{this.stopping=!1},2e3)}}})},showMessage(m,s="info"){this.message=m,this.messageType=s,setTimeout(()=>{this.message=""},4e3)}}},fi={class:"ai-settings"},bi={class:"page-header"},yi={class:"status-text"},wi={key:0,class:"quick-start"},ki={class:"section provider-section"},_i={class:"provider-grid"},$i=["onClick"],Ci={class:"provider-icon"},Mi={class:"provider-info"},xi={class:"provider-name"},Ui={key:0,class:"provider-tag"},Ai={key:1,class:"provider-tag local"},Bi={class:"section config-section"},Vi={class:"section-header"},Ti=["href"],Di={class:"config-form"},Ii={key:0,class:"form-item"},Pi={class:"input-group"},Si=["type","placeholder"],Li={key:1,class:"form-item"},Ki=["placeholder"],Ni={class:"form-item"},Wi={class:"model-select"},Ri=["value"],zi=["placeholder"],Ei={class:"advanced-settings"},Oi={class:"form-item"},qi={class:"label-value"},Hi={class:"form-item auto-generate"},Fi={class:"switch-label"},Gi={class:"switch"},ji={class:"form-actions"},Ji=["disabled"],Qi={class:"btn-icon"},Xi=["disabled"],Yi={class:"btn-icon"},Zi={class:"section batch-section"},er={class:"section-header"},sr=["disabled"],tr={key:0,class:"stats-bar"},ar={class:"stat-chip"},lr={class:"stat-num"},nr={class:"stat-num"},or={class:"stat-num"},ir={class:"stat-num"},rr={key:1,class:"task-progress"},dr={class:"progress-header"},ur={class:"progress-title"},cr={class:"progress-count"},vr={class:"progress-bar-wrapper"},pr={class:"progress-bar"},mr={class:"progress-percent"},gr={key:0,class:"progress-detail"},hr={class:"current-item"},fr={key:0,class:"eta"},br={class:"concurrency-status"},yr={class:"concurrency-label"},wr={class:"concurrency-icon"},kr=["disabled"],_r={key:2,class:"batch-actions"},$r={key:0,class:"starting-hint"},Cr={key:1,class:"action-group primary-action"},Mr=["disabled"],xr={key:2,class:"action-divider"},Ur={class:"action-grid"},Ar={class:"action-card"},Br={class:"action-card-body"},Vr=["disabled"],Tr=["disabled"],Dr={class:"action-card"},Ir={class:"action-card-body"},Pr=["disabled"],Sr=["disabled"],Lr={class:"action-card"},Kr={class:"action-card-body"},Nr=["disabled"],Wr=["disabled"],Rr={class:"toast-icon"},zr={class:"toast-text"};function Er(m,s,l,V,a,h){var P,D,p;return o(),i("div",fi,[e("div",bi,[s[22]||(s[22]=e("h2",null,"ğŸ¤– AI æ™ºèƒ½ç”Ÿæˆ",-1)),e("div",{class:W(["connection-status",h.connectionStatus])},[s[21]||(s[21]=e("span",{class:"status-dot"},null,-1)),e("span",yi,u(h.statusText),1)],2)]),!a.config.hasApiKey&&!a.config.apiKey?(o(),i("div",wi,[...s[23]||(s[23]=[re('<div class="quick-start-icon" data-v-15ad835a>ğŸš€</div><div class="quick-start-content" data-v-15ad835a><h4 data-v-15ad835a>å¿«é€Ÿå¼€å§‹</h4><p data-v-15ad835a>é…ç½® AI æœåŠ¡åï¼Œå¯è‡ªåŠ¨ä¸ºå¡ç‰‡ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾</p><div class="quick-start-steps" data-v-15ad835a><span class="step" data-v-15ad835a>1. é€‰æ‹©æä¾›å•†</span><span class="step" data-v-15ad835a>2. å¡«å†™ API Key</span><span class="step" data-v-15ad835a>3. æµ‹è¯•è¿æ¥</span></div></div>',2)])])):K("",!0),e("div",ki,[s[24]||(s[24]=e("div",{class:"section-header"},[e("h3",null,"é€‰æ‹© AI æä¾›å•†"),e("span",{class:"section-hint"},"æ¨èä½¿ç”¨ DeepSeekï¼Œæ€§ä»·æ¯”é«˜")],-1)),e("div",_i,[(o(!0),i(H,null,F(a.providers,(n,y)=>(o(),i("div",{key:y,class:W(["provider-card",{active:a.config.provider===y,recommended:n.recommended}]),onClick:f=>h.selectProvider(y)},[e("div",Ci,u(n.icon),1),e("div",Mi,[e("span",xi,u(n.name),1),n.recommended?(o(),i("span",Ui,"æ¨è")):K("",!0),n.local?(o(),i("span",Ai,"æœ¬åœ°")):K("",!0)])],10,$i))),128))])]),e("div",Bi,[e("div",Vi,[s[25]||(s[25]=e("h3",null,"API é…ç½®",-1)),h.currentProvider.docsUrl?(o(),i("a",{key:0,href:h.currentProvider.docsUrl,target:"_blank",class:"docs-link"}," ğŸ“– è·å– API Key ",8,Ti)):K("",!0)]),e("div",Di,[h.needsApiKey?(o(),i("div",Ii,[e("label",null,[s[26]||(s[26]=e("span",{class:"label-text"},"API Key",-1)),e("span",{class:W(["label-status",{configured:a.config.hasApiKey}])},u(a.config.hasApiKey?"âœ“ å·²é…ç½®":"æœªé…ç½®"),3)]),e("div",Pi,[U(e("input",{type:a.showApiKey?"text":"password","onUpdate:modelValue":s[0]||(s[0]=n=>a.config.apiKey=n),placeholder:a.config.hasApiKey?"å·²é…ç½®ï¼ˆç•™ç©ºä¿æŒä¸å˜ï¼‰":"è¯·è¾“å…¥ API Key",class:"input"},null,8,Si),[[Pe,a.config.apiKey]]),e("button",{type:"button",class:"input-btn",onClick:s[1]||(s[1]=n=>a.showApiKey=!a.showApiKey),title:"æ˜¾ç¤º/éšè—"},u(a.showApiKey?"ğŸ™ˆ":"ğŸ‘ï¸"),1),e("button",{type:"button",class:"input-btn",onClick:s[2]||(s[2]=(...n)=>h.pasteApiKey&&h.pasteApiKey(...n)),title:"ç²˜è´´"}," ğŸ“‹ ")])])):K("",!0),h.needsBaseUrl?(o(),i("div",Li,[s[27]||(s[27]=e("label",null,[e("span",{class:"label-text"},"Base URL")],-1)),U(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=n=>a.config.baseUrl=n),placeholder:h.currentProvider.defaultBaseUrl||"è¯·è¾“å…¥ API åœ°å€",class:"input"},null,8,Ki),[[L,a.config.baseUrl]]),s[28]||(s[28]=e("span",{class:"form-hint"},"ä¸éœ€è¦åŠ  /v1/chat/completions",-1))])):K("",!0),e("div",Ni,[s[30]||(s[30]=e("label",null,[e("span",{class:"label-text"},"æ¨¡å‹")],-1)),e("div",Wi,[U(e("select",{"onUpdate:modelValue":s[4]||(s[4]=n=>a.selectedModel=n),class:"input",onChange:s[5]||(s[5]=(...n)=>h.onModelChange&&h.onModelChange(...n))},[s[29]||(s[29]=e("option",{value:""},"è‡ªå®šä¹‰æ¨¡å‹",-1)),(o(!0),i(H,null,F(h.currentProvider.models,n=>(o(),i("option",{key:n,value:n},u(n),9,Ri))),128))],544),[[ye,a.selectedModel]]),a.selectedModel===""?U((o(),i("input",{key:0,type:"text","onUpdate:modelValue":s[6]||(s[6]=n=>a.config.model=n),placeholder:h.currentProvider.defaultModel,class:"input model-input"},null,8,zi)),[[L,a.config.model]]):K("",!0)])]),e("div",{class:"advanced-toggle",onClick:s[7]||(s[7]=n=>a.showAdvanced=!a.showAdvanced)},[e("span",null,u(a.showAdvanced?"â–¼":"â–¶")+" é«˜çº§è®¾ç½®",1)]),U(e("div",Ei,[e("div",Oi,[e("label",null,[s[31]||(s[31]=e("span",{class:"label-text"},"è¯·æ±‚é—´éš”",-1)),e("span",qi,u(a.config.requestDelay)+"ms",1)]),U(e("input",{type:"range","onUpdate:modelValue":s[8]||(s[8]=n=>a.config.requestDelay=n),min:"500",max:"5000",step:"100",class:"slider"},null,512),[[L,a.config.requestDelay,void 0,{number:!0}]]),s[32]||(s[32]=e("span",{class:"form-hint"},"æ‰¹é‡ç”Ÿæˆæ—¶çš„è°ƒç”¨é—´éš”ï¼Œé˜²æ­¢è§¦å‘é™æµ",-1))])],512),[[be,a.showAdvanced]]),e("div",Hi,[e("label",Fi,[s[34]||(s[34]=e("span",{class:"switch-text"},[e("span",{class:"switch-title"},"è‡ªåŠ¨ç”Ÿæˆ"),e("span",{class:"switch-desc"},"æ·»åŠ å¡ç‰‡æ—¶è‡ªåŠ¨ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾")],-1)),e("label",Gi,[U(e("input",{type:"checkbox","onUpdate:modelValue":s[9]||(s[9]=n=>a.config.autoGenerate=n)},null,512),[[ae,a.config.autoGenerate]]),s[33]||(s[33]=e("span",{class:"switch-slider"},null,-1))])])]),e("div",ji,[e("button",{class:"btn btn-outline",onClick:s[10]||(s[10]=(...n)=>h.testConnection&&h.testConnection(...n)),disabled:a.testing||!h.canTest},[e("span",Qi,u(a.testing?"â³":"ğŸ”—"),1),z(" "+u(a.testing?"æµ‹è¯•ä¸­...":"æµ‹è¯•è¿æ¥"),1)],8,Ji),e("button",{class:"btn btn-primary",onClick:s[11]||(s[11]=(...n)=>h.saveConfig&&h.saveConfig(...n)),disabled:a.saving},[e("span",Yi,u(a.saving?"â³":"ğŸ’¾"),1),z(" "+u(a.saving?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Xi)])])]),e("div",Zi,[e("div",er,[s[35]||(s[35]=e("h3",null,"æ‰¹é‡ç”Ÿæˆ",-1)),e("button",{class:"btn-icon-only",onClick:s[12]||(s[12]=(...n)=>h.refreshStats&&h.refreshStats(...n)),disabled:a.refreshing,title:"åˆ·æ–°ç»Ÿè®¡"},u(a.refreshing?"â³":"ğŸ”„"),9,sr)]),a.stats?(o(),i("div",tr,[e("div",ar,[e("span",lr,u(a.stats.total),1),s[36]||(s[36]=e("span",{class:"stat-label"},"æ€»æ•°",-1))]),e("div",{class:W(["stat-chip",{warning:a.stats.emptyName>0}])},[e("span",nr,u(a.stats.emptyName),1),s[37]||(s[37]=e("span",{class:"stat-label"},"ç¼ºåç§°",-1))],2),e("div",{class:W(["stat-chip",{warning:a.stats.emptyDesc>0}])},[e("span",or,u(a.stats.emptyDesc),1),s[38]||(s[38]=e("span",{class:"stat-label"},"ç¼ºæè¿°",-1))],2),e("div",{class:W(["stat-chip",{warning:a.stats.emptyTags>0}])},[e("span",ir,u(a.stats.emptyTags),1),s[39]||(s[39]=e("span",{class:"stat-label"},"ç¼ºæ ‡ç­¾",-1))],2)])):K("",!0),a.batchRunning?(o(),i("div",rr,[e("div",dr,[e("span",ur,[s[40]||(s[40]=e("span",{class:"progress-icon"},"âš¡",-1)),z(" "+u(h.batchLabel),1)]),e("span",cr,u(a.batchProgress.current)+" / "+u(a.batchProgress.total),1)]),e("div",vr,[e("div",pr,[e("div",{class:"progress-fill",style:we({width:h.progressPercent+"%"})},[...s[41]||(s[41]=[e("div",{class:"progress-shine"},null,-1)])],4)]),e("span",mr,u(h.progressPercent)+"%",1)]),a.batchProgress.currentCard?(o(),i("div",gr,[e("span",hr,[s[42]||(s[42]=e("span",{class:"current-label"},"å½“å‰ï¼š",-1)),z(" "+u(a.batchProgress.currentCard),1)]),h.estimatedTime?(o(),i("span",fr,"â±ï¸ "+u(h.estimatedTime),1)):K("",!0)])):K("",!0),e("div",br,[e("span",yr,[e("span",wr,u(a.batchProgress.isRateLimited?"ğŸ¢":"ğŸš€"),1),z(" "+u(h.concurrencyText),1)]),e("span",{class:W(["concurrency-badge",h.concurrencyClass])}," å¹¶å‘ "+u(a.batchProgress.concurrency||1),3)]),e("button",{class:"btn btn-danger btn-sm",onClick:s[13]||(s[13]=(...n)=>h.stopBatch&&h.stopBatch(...n)),disabled:a.stopping},u(a.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,kr)])):(o(),i("div",_r,[a.starting?(o(),i("div",$r,[...s[43]||(s[43]=[e("div",{class:"starting-spinner"},null,-1),e("span",null,"æ­£åœ¨å¯åŠ¨ä»»åŠ¡...",-1)])])):K("",!0),h.totalMissing>0?(o(),i("div",Cr,[e("button",{class:"btn btn-primary btn-lg",onClick:s[14]||(s[14]=(...n)=>h.startBatchAll&&h.startBatchAll(...n)),disabled:a.starting||!a.config.hasApiKey},[s[44]||(s[44]=e("span",{class:"btn-icon"},"âœ¨",-1)),z(" ä¸€é”®è¡¥å…¨æ‰€æœ‰ç¼ºå¤± ("+u(h.totalMissing)+") ",1)],8,Mr),s[45]||(s[45]=e("span",{class:"action-hint"},"è‡ªåŠ¨è¡¥å……ç¼ºå°‘çš„åç§°ã€æè¿°å’Œæ ‡ç­¾",-1))])):K("",!0),h.totalMissing>0?(o(),i("div",xr,[...s[46]||(s[46]=[e("span",null,"æˆ–é€‰æ‹©å•é¡¹æ“ä½œ",-1)])])):K("",!0),e("div",Ur,[e("div",Ar,[s[47]||(s[47]=e("div",{class:"action-card-header"},[e("span",{class:"action-icon"},"ğŸ“"),e("span",{class:"action-title"},"åç§°")],-1)),e("div",Br,[e("button",{class:"btn btn-sm",onClick:s[15]||(s[15]=n=>h.startBatch("name","empty")),disabled:!a.stats||a.stats.emptyName===0||a.starting||!a.config.hasApiKey}," è¡¥å……ç¼ºå¤± ("+u(((P=a.stats)==null?void 0:P.emptyName)||0)+") ",9,Vr),e("button",{class:"btn btn-sm btn-outline-warning",onClick:s[16]||(s[16]=n=>h.startBatch("name","all")),disabled:!a.stats||a.stats.total===0||a.starting||!a.config.hasApiKey}," å…¨éƒ¨é‡æ–°ç”Ÿæˆ ",8,Tr)])]),e("div",Dr,[s[48]||(s[48]=e("div",{class:"action-card-header"},[e("span",{class:"action-icon"},"ğŸ“„"),e("span",{class:"action-title"},"æè¿°")],-1)),e("div",Ir,[e("button",{class:"btn btn-sm",onClick:s[17]||(s[17]=n=>h.startBatch("description","empty")),disabled:!a.stats||a.stats.emptyDesc===0||a.starting||!a.config.hasApiKey}," è¡¥å……ç¼ºå¤± ("+u(((D=a.stats)==null?void 0:D.emptyDesc)||0)+") ",9,Pr),e("button",{class:"btn btn-sm btn-outline-warning",onClick:s[18]||(s[18]=n=>h.startBatch("description","all")),disabled:!a.stats||a.stats.total===0||a.starting||!a.config.hasApiKey}," å…¨éƒ¨é‡æ–°ç”Ÿæˆ ",8,Sr)])]),e("div",Lr,[s[49]||(s[49]=e("div",{class:"action-card-header"},[e("span",{class:"action-icon"},"ğŸ·ï¸"),e("span",{class:"action-title"},"æ ‡ç­¾")],-1)),e("div",Kr,[e("button",{class:"btn btn-sm",onClick:s[19]||(s[19]=n=>h.startBatch("tags","empty")),disabled:!a.stats||a.stats.emptyTags===0||a.starting||!a.config.hasApiKey}," è¡¥å……ç¼ºå¤± ("+u(((p=a.stats)==null?void 0:p.emptyTags)||0)+") ",9,Nr),e("button",{class:"btn btn-sm btn-outline-warning",onClick:s[20]||(s[20]=n=>h.startBatch("tags","all")),disabled:!a.stats||a.stats.total===0||a.starting||!a.config.hasApiKey}," å…¨éƒ¨é‡æ–°ç”Ÿæˆ ",8,Wr)])])])]))]),Ie(Le,{name:"toast"},{default:Se(()=>[a.message?(o(),i("div",{key:0,class:W(["toast",a.messageType])},[e("span",Rr,u(h.messageIcon),1),e("span",zr,u(a.message),1)],2)):K("",!0)]),_:1})])}const Or=Y(hi,[["render",Er],["__scopeId","data-v-15ad835a"]]),qr={key:0,class:"login-container"},Hr={class:"login-card"},Fr={class:"login-form"},Gr={class:"password-input-wrapper"},jr=["type"],Jr={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Qr={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Xr={class:"login-buttons"},Yr=["disabled"],Zr={key:0,class:"login-error"},ed={key:1,class:"admin-layout"},sd={class:"menu-list"},td={class:"admin-main"},ad={class:"admin-header"},ld={class:"header-title"},nd={class:"admin-content"},De=1800*1e3,od={__name:"Admin",setup(m){const s=_("welcome");let l=null,V=Date.now();function a(){V=Date.now(),localStorage.setItem("lastActivityTime",V.toString()),l&&clearTimeout(l),r.value&&(l=setTimeout(()=>{h()},De))}function h(){r.value&&(alert("ç”±äºé•¿æ—¶é—´æœªæ“ä½œï¼Œå·²è‡ªåŠ¨é€€å‡ºç™»å½•"),R())}function P(){const I=localStorage.getItem("lastActivityTime");return I&&Date.now()-parseInt(I)>=De?(localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),!0):!1}const D=["mousedown","mousemove","keydown","scroll","touchstart","click"];function p(){D.forEach(I=>{document.addEventListener(I,a,{passive:!0})})}function n(){D.forEach(I=>{document.removeEventListener(I,a)})}Ge(()=>{l&&clearTimeout(l),n()});const y={welcome:Us,menu:wt,card:oa,duplicate:Oa,tag:il,promo:Nl,friend:jl,user:pn,backup:gi,ai:Or},f=ie(()=>y[s.value]),M=ie(()=>s.value==="welcome"?{lastLoginTime:b.value,lastLoginIp:c.value,currentUsername:v.value}:{}),b=_(""),c=_(""),v=_("admin"),r=_(!1),A=_(""),C=_(""),x=_(!1),O=_(""),J=_(!1),Z=_(!1),ee=ie(()=>{switch(s.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"promo":return"å®£ä¼ ç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";case"ai":return"AI è®¾ç½®";default:return""}});le(()=>B(null,null,function*(){if(P()){r.value=!1;return}localStorage.getItem("token")?(r.value=!0,yield te(),r.value&&(a(),p())):r.value=!1}));function te(){return B(this,null,function*(){try{const I=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(I.ok){const g=yield I.json();b.value=g.last_login_time||"",c.value=g.last_login_ip||"",v.value=g.username||"admin"}else I.status===401&&(console.warn("TokenéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨é€€å‡ºç™»å½•"),R())}catch(I){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",I)}})}function se(){return B(this,null,function*(){var I,g;if(!A.value||!C.value){O.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}x.value=!0,O.value="";try{const d=yield bs(A.value,C.value);d.data.token&&(localStorage.setItem("token",d.data.token),r.value=!0,b.value=d.data.lastLoginTime||"",c.value=d.data.lastLoginIp||"",yield te(),a(),p())}catch(d){O.value=((g=(I=d.response)==null?void 0:I.data)==null?void 0:g.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{x.value=!1}})}function R(){l&&(clearTimeout(l),l=null),n(),localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),r.value=!1,A.value="",C.value="",O.value=""}function N(){window.open("/","_blank")}function k(){Z.value=!Z.value}function T(){Z.value=!1}return(I,g)=>r.value?(o(),i("div",ed,[e("aside",{class:W(["admin-sider",{open:Z.value}]),onClick:Me(T,["self"])},[e("div",{class:"logo clickable",onClick:g[3]||(g[3]=d=>{s.value="welcome",T()})},"Admin"),e("ul",sd,[e("li",{class:W({active:s.value==="menu"}),onClick:g[4]||(g[4]=d=>{s.value="menu",T()})},"æ ç›®ç®¡ç†",2),e("li",{class:W({active:s.value==="card"}),onClick:g[5]||(g[5]=d=>{s.value="card",T()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:W({active:s.value==="duplicate"}),onClick:g[6]||(g[6]=d=>{s.value="duplicate",T()})},"å»é‡ç®¡ç†",2),e("li",{class:W({active:s.value==="tag"}),onClick:g[7]||(g[7]=d=>{s.value="tag",T()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:W({active:s.value==="promo"}),onClick:g[8]||(g[8]=d=>{s.value="promo",T()})},"å®£ä¼ ç®¡ç†",2),e("li",{class:W({active:s.value==="friend"}),onClick:g[9]||(g[9]=d=>{s.value="friend",T()})},"å‹é“¾ç®¡ç†",2),e("li",{class:W({active:s.value==="user"}),onClick:g[10]||(g[10]=d=>{s.value="user",T()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:W({active:s.value==="backup"}),onClick:g[11]||(g[11]=d=>{s.value="backup",T()})},"å¤‡ä»½ç®¡ç†",2),e("li",{class:W({active:s.value==="ai"}),onClick:g[12]||(g[12]=d=>{s.value="ai",T()})},"AI è®¾ç½®",2)])],2),e("main",td,[e("div",ad,[e("button",{class:"menu-toggle",onClick:k}," â˜° "),e("div",ld,u(ee.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:N,title:"è¿›å…¥ä¸»é¡µ"},[...g[17]||(g[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:R},"é€€å‡ºç™»å½•")])]),e("div",nd,[Ie(Le,{name:"fade",mode:"out-in"},{default:Se(()=>[(o(),je(Je(f.value),Qe({key:s.value},M.value),null,16))]),_:1})]),g[18]||(g[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[z("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(o(),i("div",qr,[e("div",Hr,[g[16]||(g[16]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",Fr,[U(e("input",{"onUpdate:modelValue":g[0]||(g[0]=d=>A.value=d),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:Ce(se,["enter"])},null,544),[[L,A.value]]),e("div",Gr,[U(e("input",{"onUpdate:modelValue":g[1]||(g[1]=d=>C.value=d),type:J.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:Ce(se,["enter"])},null,40,jr),[[Pe,C.value]]),e("span",{class:"toggle-password",onClick:g[2]||(g[2]=d=>J.value=!J.value)},[J.value?(o(),i("svg",Jr,[...g[13]||(g[13]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(o(),i("svg",Qr,[...g[14]||(g[14]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",Xr,[e("button",{onClick:N,class:"back-btn"},[...g[15]||(g[15]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),z(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:se,class:"login-btn",disabled:x.value},u(x.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,Yr)]),O.value?(o(),i("p",Zr,u(O.value),1)):K("",!0)])])]))}},ud=Y(od,[["__scopeId","data-v-52d75759"]]);export{ud as default};
